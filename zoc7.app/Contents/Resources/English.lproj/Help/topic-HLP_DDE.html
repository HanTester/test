<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<META HTTP-EQUIV="Content-Style-Type" content="text/css">
<LINK REL="stylesheet" type="text/css" href="helpfile.css">
<TITLE>Introduction to ZOC DDE Programming (Windows)</TITLE>

</HEAD>

<BODY STYLE="FONT-FAMILY: Lucida Grande, Arial, Sans Serif; FONT-SIZE: 10pt;" BGCOLOR="#FFFFFF" TEXT="#000000">

<A NAME="HLP_DDE"></A>


<!-- \page -->
<!-- {\footnote HLP_DDE} -->
<!-- {\footnote Introduction to ZOC DDE Programming (Windows)} -->

<h2>Introduction to ZOC DDE Programming (Windows)</h2><p>

The Dynamic Data Exchange method (DDE) allows other Windows programs to 
execute ZOC-commands remotely. While <a class="link" href=topic-HLP_REXX.html>REXX Programs</a> 
must run under control of ZOC, it is possible to let separate 
applications (e.g. ones written in C++) send requests to ZOC for processing. 
&nbsp;</p><p>In this introduction it is assumed that the reader knows about the 
basic concepts of DDE. The topics below deal only with implementation 
specific details. 
&nbsp;</p><p>A more detailed description and sample applications can be downloaded 
from <a class="ilink" href="ftp://ftp.emtec.com/zoc/" target="_blank">ftp://ftp.emtec.com/zoc/</a> 
<table><tr><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td>&nbsp;</td></tr> 
<tr><td class="pthead1" colspan=2><b>Sessions/Topics</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
ZOC will accept only one session at a time. The application identifier 
is <font class="example" color="207030" face="Courier New"><span class="example">ZOC</span></font> and ZOC responds to the topics <font class="example" color="207030" face="Courier New"><span class="example">COMMUNICATION</span></font>, 
<font class="example" color="207030" face="Courier New"><span class="example">COMM</span></font> and <font class="example" color="207030" face="Courier New"><span class="example">COMM-DEBUG</span></font> (the difference is, that the latter 
logs DDE events in the ZOC window to help debugging). ZOC does not 
respond to general DDE-requests (ones that do not specify app or topic). 
&nbsp;</p><p>In addition to the application name <font class="example" color="207030" face="Courier New"><span class="example">ZOC</span></font>, ZOC also responds 
to <font class="example" color="207030" face="Courier New"><span class="example">ZOCn</span></font>, where n is a number that reflects the number of 
concurrently started ZOC instances. The first one is called <font class="example" color="207030" face="Courier New"><span class="example">ZOC1</span></font>, 
the next one reacts to <font class="example" color="207030" face="Courier New"><span class="example">ZOC2</span></font> etc. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><b>Sending Commands</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
You can send commands to ZOC either via DDE_EXECUTE (data field) or 
DDE_REQUEST (item field). DDE_EXECUTE always responds with an DDE_ACK 
message with a numeric return code in the AppRc field. DDE_REQUEST always 
sends a DDE_DATA packet (even in case of error) with a result or with the 
string <font class="example" color="207030" face="Courier New"><span class="example">##ERROR##</span></font> in the data field. The DDE_DATA packet must 
not be acknowledged. Under Windows the data handle must be freed by 
the receiver. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><b>Serialization</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Commands must be strictly sent on a command-reply basis. ZOC does not 
handle nested commands (e.g. sending another command while a ZocWait command 
is pending). 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><b>Command Format</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
DDE_EXECUTE and DDE_REQUEST accept the same form of commands, they only differ 
in the fact, that EXECUTE cannot be used to retrieve return values from 
functions. The commands must be zero terminated (C-style strings). 
&nbsp;</p><p>ZOC does not handle commands enclosed in square brackets (as 
recommended in the Microsoft DDE specification) and it does not 
handle multiple commands per message. Unicode is not supported. 
&nbsp;</p><p>A command can be sent in the form <font class="example" color="207030" face="Courier New"><span class="example">&lt;command&gt; &lt;arguments&gt;</span></font> or 
<font class="example" color="207030" face="Courier New"><span class="example">&lt;command&gt;(&lt;arguments&gt;)</span></font>. The arguments can be separated by 
blank or comma. However, the recommended style is with brackets and comma. 
String should be placed between quotation marks but it is legal 
to send them without if they do not contain special characters. 
&nbsp;</p><p>Here is a list of valid command strings. For backward 
compatibility it is legal to omit the letters ZOC at the beginning of 
the command words. 
<br/><font class="example" color="207030" face="Courier New"><span class="example">&nbsp;<div class="lines"> 
ZocBeep(2)<br/> 
ZocMsgBox("Hello World!", 2)<br/> 
ZocNotify('File "FOOBAR.DATA" not found!')<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
ZocRequest "How's life?" "Fine" "Not Bad"<br/> 
Notify Error<br/> 
Beep 2<br/> 
</div></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><b>List of Commands</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Via DDE you can use the same set of commands/functions as in REXX. The 
list can be found in the <a class="link" href=topic-HLP_APXRXCMDS.html>ZOC-Command Reference</a> in the 
appendix. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><b>Example</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
The following code is a small example of how to start a DDE connection 
via Microsoft Access Basic, to initialize the modem and check if it 
returns "OK". 
<br/><font class="example" color="207030" face="Courier New"><span class="example">&nbsp;<div class="lines"> 
ZocDDE = DDEInitiate("ZOC", "Comm-Debug")<br/> 
DDEExecute ZocDDE, "ZocClearScreen"<br/> 
DDEExecute ZocDDE, "ZocTimeout(60)"<br/> 
DDEExecute ZocDDE, "ZocSend('ATZ^M')"<br/> 
rc = DDERequest(ZocDDE, "ZocWait('OK')")<br/> 
Debug.Print rc<br/> 
DDETerminate ZocDDE<br/> 
</div></span></font> 
</table>&nbsp;<br/> 
&nbsp;</p>
<p>&nbsp;</p>
</BODY>
</HTML>
