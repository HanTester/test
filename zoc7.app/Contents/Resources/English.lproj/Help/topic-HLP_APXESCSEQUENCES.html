<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<META HTTP-EQUIV="Content-Style-Type" content="text/css">
<LINK REL="stylesheet" type="text/css" href="helpfile.css">
<TITLE>Extended Escape-Sequences</TITLE>

</HEAD>

<BODY STYLE="FONT-FAMILY: Lucida Grande, Arial, Sans Serif; FONT-SIZE: 10pt;" BGCOLOR="#FFFFFF" TEXT="#000000">

<A NAME="HLP_APXESCSEQUENCES"></A>


<!-- \page -->
<!-- {\footnote HLP_APXESCSEQUENCES} -->
<!-- {\footnote Extended Escape-Sequences} -->

<h2>Extended Escape-Sequences</h2><p>

The following escape-sequences extend the normal range of sequences (the normal sequences 
define the behavior of ZOC depending on the chosen each emulation). &nbsp;</p><p> 
Their main purpose of the extended sequences is to allow a host to control specific features 
or invoke specific actions through ZOC. &nbsp;</p><p> 
The sequences typically start with <font class="example" color="207030" face="Courier New"><span class="example">ESC ]</span></font> (<font class="syntax" color="4060A0" face="Courier New"><span class="syntax">hex 1B 5D</span></font>) or 
<font class="example" color="207030" face="Courier New"><span class="example">ESC [</span></font> (<font class="syntax" color="4060A0" face="Courier New"><span class="syntax">hex 1B 5B</span></font>), followed by a variable part and 
a termination character like <font class="example" color="207030" face="Courier New"><span class="example">^G</span></font> (<font class="syntax" color="4060A0" face="Courier New"><span class="syntax">hex 07</span></font>) or <font class="example" color="207030" face="Courier New"><span class="example">CR</span></font> (<font class="syntax" color="4060A0" face="Courier New"><span class="syntax">hex 0D</span></font>). &nbsp;</p><p> 
Other characters in the syntactic samples below denote themselves, except for spaces (which 
should be ignored) and text in brackets (which is a placeholder for a variable part of 
your own choice). &nbsp;</p><p> 
For example, a valid implementation of the sequence <font class="syntax" color="4060A0" face="Courier New"><span class="syntax">ESC ] 0 ; &lt;title&gt; ^G</span></font> is the byte 
series <font class="syntax" color="4060A0" face="Courier New"><span class="syntax">hex 1B 5D 30 3B 5A 4F 43 07</span></font> (set window title to "ZOC"). 
<table><tr><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td>&nbsp;</td></tr> 
<tr><td class="pthead1" colspan=2><b>Change Window Title: <font class="syntax" color="4060A0" face="Courier New"><span class="syntax">ESC ] 0 ; &lt;title&gt; ^G</span></font></b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
The sequence allows the remote program to change the title for the window (or tab) in which the session runs. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><b>Change Window Title (alternate): <font class="syntax" color="4060A0" face="Courier New"><span class="syntax">ESC [ | $ t = &lt;title&gt; CR</span></font></b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
The sequence is an alternate version of the above and also allows 
the remote program to change the title of the window. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><b>Clear Screen and Reset Emulation: <font class="syntax" color="4060A0" face="Courier New"><span class="syntax">ESC ] R</span></font></b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
A byte sequence of <font class="syntax" color="4060A0" face="Courier New"><span class="syntax">hex 1B 5D 52</span></font> will perform a clear screen and emulation reset (this is identical 
to the user choosing Clear Screen from the View menu). 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><b>Start Local Command: <font class="syntax" color="4060A0" face="Courier New"><span class="syntax">ESC [ | &lt;command&gt; CR</span></font></b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
A host can send this sequence to perform a command locally through ZOC. Since this can cause potential 
security problems, the sequence is ignored, unless a file named <font class="example" color="207030" face="Courier New"><span class="example">remoterun.flg</span></font> exists in the ZOC 
program folder (Windows) or unless a file named <font class="example" color="207030" face="Courier New"><span class="example">.zoc7_remoterunflag</span></font> exists in the user's 
home folder (Mac OS). 
<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
The command is passed to Windows through the CreateProcess API and can contain optional parameters, 
e.g. <font class="example" color="207030" face="Courier New"><span class="example">notepad.exe newfile.txt</span></font>.<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
If the command parameter starts with <font class="example" color="207030" face="Courier New"><span class="example">http://</span></font>, <font class="example" color="207030" face="Courier New"><span class="example">https://</span></font> or 
<font class="example" color="207030" face="Courier New"><span class="example">ftp://</span></font>, the URL will be passed to user's the default web browser.<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
If the command starts with the text <font class="example" color="207030" face="Courier New"><span class="example">%SHELLOPEN%</span></font> followed by a space character and a file name, 
the file will be opened through the operating system using the user's chosen default program, e.g. 
<font class="example" color="207030" face="Courier New"><span class="example">%SHELLOPEN% C:\ZOC\piechart.jpg</span></font><br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
There are also some placeholders: <font class="syntax" color="4060A0" face="Courier New"><span class="syntax">DOWNLOADDIR</span></font>, <font class="syntax" color="4060A0" face="Courier New"><span class="syntax">LASTDOWNLOADEDFILE</span></font>, <font class="syntax" color="4060A0" face="Courier New"><span class="syntax">LASTSPOOLFILE</span></font>.<br> 
When these appear either between percent-signs (e.g. <font class="example" color="207030" face="Courier New"><span class="example">%LASTDOWNLOADEDFILE%</span></font>) or in brackets after 
a dollar sign (e.g <font class="example" color="207030" face="Courier New"><span class="example">$(LASTSPOOLFILE)</span></font>), they will be replaced by their respective values 
before executing the command. A typical sample could be a host sending a report to the user via Zmodem 
and then opening it via <font class="example" color="207030" face="Courier New"><span class="example">%SHELLOPEN% "%DOWNLOADDIR%\thereport.pdf"</span></font> or <font class="example" color="207030" face="Courier New"><span class="example">%SHELLOPEN% "%LASTDOWNLOADEDFILE%"</span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><b>NetTerm Compatibility: <font class="syntax" color="4060A0" face="Courier New"><span class="syntax">ESC [ ] &lt;parameter&gt; ESC [ &lt;n&gt; *</span></font></b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
ZOC supports a range of sequences from NetTerm to perform operations on the local computer that runs the terminal. <br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
The 2nd parameter is a decimal number which determines the function to perform. 
The meaning of the <font color="5080A0"><i>&lt;paramter&gt;</i></font> thus depends on <font color="5080A0"><i>&lt;n&gt;</i></font> as described below: <br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
<b>0</b> - URL to open in the local browser, e.g. <font class="example" color="207030" face="Courier New"><span class="example">ESC [ ] http://www.emtec.com/ ESC [ 0 *</span></font><br> 
<b>1</b> - Command to perform locally (same as the 'start local command' sequence above).<br> 
<b>6</b> - Directory to use as the download directory.<br> 
<b>7</b> - Directory to use as the upload directory.<br> 
<b>8</b> - Name and path of file to transfer when the next upload is invoked.<br> 
<b>11</b> - Text to write to the local clipboard.<br> 
<b>12</b> - Full path and name of a file to open using the associated default program for that file's type. <br> 
<b>17</b> - The static text <font class="example" color="207030" face="Courier New"><span class="example">NOWAIT</span></font>. In this case, the last downloaded file will 
be opened on the local computer (using the default program for that file's type).<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
<b>Example:</b> <font class="example" color="207030" face="Courier New"><span class="example">ESC [ ] C:\DOWNLOADS ESC [ 6 *</span></font> (<font class="syntax" color="4060A0" face="Courier New"><span class="syntax">hex 1B 5B 5D 43 3A 5C 44 4F 57 4E 4C 4F 41 44 53 1B 5B 36 2A</span></font> 
will subsequently (for this session only) store downloaded files in the folder C:\DOWNLOADS\. <br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
<b>Example:</b> <font class="example" color="207030" face="Courier New"><span class="example">ESC [ ] C:\DOWNLOADS\REPORT.PDF ESC [ 12 *</span></font> will open the file REPORT.PDF on the local 
computer, using the default viewer for PDF files. <br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
<b>Note:</b> These sequences will only be processed if the <font class="example" color="207030" face="Courier New"><span class="example">remoterun.flg</span></font> is present on the system 
(see 'start local command' above). Also, if you want to debug your use of these sequences, you can enable 
hex mode or ascii tracing in <a class="link" href=topic-DLG_WIN_OPTS_TRACEDEBUG.html>Options&rarr;Session Profile&rarr;Trace/Debug</a>. 
</table>&nbsp;<br/> 
&nbsp;</p>
<p>&nbsp;</p>
</BODY>
</HTML>
