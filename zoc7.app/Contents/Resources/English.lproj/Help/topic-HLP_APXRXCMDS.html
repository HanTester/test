<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<META HTTP-EQUIV="Content-Style-Type" content="text/css">
<LINK REL="stylesheet" type="text/css" href="helpfile.css">
<TITLE>ZOC-REXX Commands/Functions</TITLE>

</HEAD>

<BODY STYLE="FONT-FAMILY: Lucida Grande, Arial, Sans Serif; FONT-SIZE: 10pt;" BGCOLOR="#FFFFFF" TEXT="#000000">

<A NAME="HLP_APXRXCMDS"></A>


<!-- \page -->
<!-- {\footnote HLP_APXRXCMDS} -->
<!-- {\footnote ZOC-REXX Commands/Functions} -->

<h2>ZOC-REXX Commands/Functions</h2><p>

&nbsp;<br/><table class="hlbox" width="99%" cellpadding="0" cellspacing="0"><tr class="hlbox"><td class="hlbox"><b>Overview</b></td></tr></table><img src="dummy.gif" alt="nil" width="200" height="12" /><br/> 
The section below lists the ZOC extensions to the REXX scripting language in alphabetical order 
(see also <a class="link" href=topic-HLP_REXXZOCFNCCATEGORY.html>ZOC-REXX Commands by Category</a>). These commands extend the 
REXX language, which in itself is a full featured programming language with native programming 
elements like variables, loops, etc. &nbsp;</p><p> 
In the examples below, the native language elements are written in uppercase, e.g. 
<font class="example" color="207030" face="Courier New"><span class="example">CALL</span></font>, <font class="example" color="207030" face="Courier New"><span class="example">IF</span></font>, <font class="example" color="207030" face="Courier New"><span class="example">THEN</span></font>, <font class="example" color="207030" face="Courier New"><span class="example">SAY</span></font>. You will find an overview 
in <a class="link" href=topic-HLP_REXXREF.html>REXX Language Elements</a>.&nbsp;</p><p> 
The ZOC-commands extend the language and offer terminal emulation specific 
functions. Their names start with with <font class="syntax" color="4060A0" face="Courier New"><span class="syntax">Zoc</span></font> and the commands are written 
in CamelCase, e.g. <font class="example" color="207030" face="Courier New"><span class="example">ZocConnect</span></font>, <font class="example" color="207030" face="Courier New"><span class="example">ZocSend</span></font>, etc. 
&nbsp;</p><p>&nbsp;&nbsp;</p><p> 
&nbsp;<br/><table class="hlbox" width="99%" cellpadding="0" cellspacing="0"><tr class="hlbox"><td class="hlbox"><b>Invoking ZOC-REXX Extensions</b></td></tr></table><img src="dummy.gif" alt="nil" width="200" height="12" /><br/> 
Generally there are two types of ZOC-commands: Those which return a value or result 
(e.g. <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocAsk>ZocAsk</a></span></font>, these are also called functions) and those which just perform a 
task but don't provide a return value (e.g. <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocDelay>ZocDelay</a></span></font>).&nbsp;</p><p> 
<ul class="list"> 
<li class="list">ZOC-commands that do not return a value are invoked using the procedure call</li> 
syntax: <br><font class="syntax" color="4060A0" face="Courier New"><span class="syntax">CALL &lt;cmd-name&gt; &lt;arguments&gt;</span></font>, e.g. <font class="example" color="207030" face="Courier New"><span class="example">CALL ZocDelay 2.5</span></font> 
<li class="list">Functions that return values are invoked using the function call syntax:</li> 
<br><font class="syntax" color="4060A0" face="Courier New"><span class="syntax">&lt;result-var&gt;= &lt;cmd-name&gt;(&lt;arguments&gt;)</span></font>, e.g. <font class="example" color="207030" face="Courier New"><span class="example">answer= ZocAsk("Your name?")</span></font> 
</ul><p> 
However, if you are not interested in the result value, it is possible to simply discard 
it by calling functions (commands which return values) using the procedure style invocation. 
In other words, the statements <font class="example" color="207030" face="Courier New"><span class="example">CALL ZocDownload "ZMODEM", "SOMEFOLDER"</span></font> 
and <font class="example" color="207030" face="Courier New"><span class="example">error= ZocDownload("ZMODEM", "SOMEFOLDER")</span></font> are both correct. In fact, 
the ZOC-REXX implementation even allows this variant: <font class="example" color="207030" face="Courier New"><span class="example">CALL ZocDownload("ZMODEM", "SOMEFOLDER")</span></font> 
&nbsp;</p><p>&nbsp;&nbsp;</p><p> 
&nbsp;<br/><table class="hlbox" width="99%" cellpadding="0" cellspacing="0"><tr class="hlbox"><td class="hlbox"><b>ZOC REXX Extensions</b></td></tr></table><img src="dummy.gif" alt="nil" width="200" height="12" /><br/> 
In the list below, the use of brackets in commands titles indicates that 
you typically need to use the function style (see above), because 
the return value of the commands is usually significant.&nbsp;</p><p> 
<table><tr><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td>&nbsp;</td></tr> 
<tr><td class="pthead1" colspan=2><a name='ZocAsk'></a><b>ZocAsk([&lt;title&gt; [, &lt;preset&gt;]])</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Show a text input window and read text from user. If the second argument 
(preset) is provided, the entry field will be preset with this value. 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
answer= ZocAsk("What is the best terminal?", "ZOC")<br/> 
IF answer="ZOC" THEN ...<br/> 
</div></span></font> 
<br/>&nbsp;<br/>
<b>See also: </b> <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocDialog>ZocDialog</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocAskPassword>ZocAskPassword</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocAskFilename>ZocAskFilename</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocAskFoldername>ZocAskFoldername</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocRequest>ZocRequest</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocRequestList>ZocRequestList</a></span></font> 
<br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocAskPassword'></a><b>ZocAskPassword([&lt;title&gt;])</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Same as the ZocAsk command, except that it is intended to enter passwords, 
i.e. the entry field shows typed characters as dots and you cannot preset the 
field with a default value. 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
pw= ZocAskPassword("What's your password?")<br/> 
IF pw=="secret" THEN ...<br/> 
</div></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocAskFilename'></a><b>ZocAskFilename(&lt;title&gt; [, &lt;preselected file&gt;])</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Display a file selection window and return the filename. If the file 
dialog is cancelled, the string <font class="example" color="207030" face="Courier New"><span class="example">##CANCEL##</span></font> is returned. 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
file= ZocAskFilename("Select file to upload", "*.ZIP")<br/> 
IF file\="##CANCEL##" THEN DO<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;CALL ZocUpload "ZMODEM", file<br/> 
END<br/> 
</div></span></font> 
<br/>&nbsp;<br/>
<b>See also: </b> <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocAsk>ZocAsk</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocDialog>ZocDialog</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocFilename>ZocFilename</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocAskFilenames>ZocAskFilenames</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocAskFoldername>ZocAskFoldername</a><dummy></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocListFiles>ZocListFiles</a></span></font> 
<br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocAskFilenames'></a><b>ZocAskFilenames(&lt;title&gt; [, &lt;preselected file&gt; [, &lt;delimiter&gt;]])</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Display a window that allows selection of multiple files and return the filenames 
separated by a space character. If the file dialog is cancelled, the string 
<font class="example" color="207030" face="Courier New"><span class="example">##CANCEL##</span></font> is returned. <br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
The items can then be extracted from the list by using the <font class="example" color="207030" face="Courier New"><span class="example">ZocString("WORD", idx)</span></font> 
function. If you expect filenames to contain space characters, you need to supply 
a different delimiter and use the <font class="example" color="207030" face="Courier New"><span class="example">ZocString("PART", idx, "|")</span></font> function instead. 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
files= ZocAskFilenames("Select file to process", "*.ZIP", "|")<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
howmany= ZocString("PARTCOUNT", files, "|")<br/> 
DO i=1 TO howmany<br/> 
&nbsp;name= ZocString("PART", files, i, "|")<br/> 
&nbsp;SAY i||". NAME= "||name<br/> 
END<br/> 
</div></span></font> 
<br/>&nbsp;<br/>
<b>See also: </b> <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocFilename>ZocFilename</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocAskFilename>ZocAskFilename</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocAskFoldername>ZocAskFoldername</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocListFiles>ZocListFiles</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocMessageBox>ZocMessageBox</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocRequest>ZocRequest</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocRequestList>ZocRequestList</a></span></font> 
<br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocAskFoldername'></a><b>ZocAskFoldername(&lt;title&gt; [, &lt;preselected folder&gt;])</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Display a folder selection dialog and return the name of the selected folder. 
If the dialog is cancelled, the string <font class="example" color="207030" face="Courier New"><span class="example">##CANCEL##</span></font> is returned. 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
folder= ZocAskFoldername("Select Folder")<br/> 
IF folder\="##CANCEL##" THEN DO<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;SAY folder<br/> 
END<br/> 
</div></span></font> 
<br/>&nbsp;<br/>
<b>See also: </b> <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocFilename>ZocFilename</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocAskFilename>ZocAskFilename</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocAskFilenames>ZocAskFilenames</a></span></font> 
<br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocBeep'></a><b>ZocBeep [&lt;n&gt;]</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Beep n times. 
&nbsp;<br/>&nbsp;<br/><b><font color="404060">Example</font>: </b><br/><img src="dummy.gif" alt="nil" width="100" height="6" /><br/><font class="example" color="207030" face="Courier New"><span class="example">CALL ZocBeep 2</span></font><br/> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocClipboard'></a><b>ZocClipboard &lt;subcommand&gt; [, &lt;writestring&gt;]</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Performs a clipboard function for one of the following subcommands: 
<table><tr><td><img src='dummy.gif' border='0' width='40' height='12' /></td><td></td></tr> 
<tr><td class="pthead2" colspan=2><b><font color="#505060">READ</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Returns the current content of the clipboard 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">WRITE</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Writes the string from the 2nd parameter to the clipboard 
</table><img src='dummy.gif' border='0' width='40' height='12' /><br/> 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
clip= ZocClipboard("READ")<br/> 
newclip= clip||ZocCtrlString("^M^J Zoc was here!")<br/> 
CALL ZocClipboard "WRITE", newclip)<br/> 
</div></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocClearScreen'></a><b>ZocClearScreen</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Clears the screen and resets the emulation to its initial state. 
&nbsp;<br/>&nbsp;<br/><b><font color="404060">Example</font>: </b><br/><img src="dummy.gif" alt="nil" width="100" height="6" /><br/><font class="example" color="207030" face="Courier New"><span class="example">CALL ZocClearScreen</span></font><br/> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocCommand'></a><b>ZocCommand &lt;subcommand&gt;</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Performs a function for one of the following subcommands: 
<table><tr><td><img src='dummy.gif' border='0' width='40' height='12' /></td><td></td></tr> 
<tr><td class="pthead2" colspan=2><b><font color="#505060">CLS</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Clear screen. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">CLEARSCROLLBACK</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Clear scrollback buffer. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">CANCELCONNECT</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Cancel a connect request that is currently in progress. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">LOADGLOBALCOLORS</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Reload the global color table from file (default file name or 2nd Parameter). 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">SAVEPROGRAMSETTINGS</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Permanently stores changes, which were made via the <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSetProgramOption>ZocSetProgramOption</a></span></font> command. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">SENDBREAK</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Sends a modem break signal (Serial/Modem connections only). 
</table><img src='dummy.gif' border='0' width='40' height='12' /><br/> 
&nbsp;<br/>&nbsp;<br/><b><font color="404060">Example</font>: </b><br/><img src="dummy.gif" alt="nil" width="100" height="6" /><br/><font class="example" color="207030" face="Courier New"><span class="example">CALL ZocCommand "DISCONNECT"</span></font><br/> 
<br/>&nbsp;<br/>
<b>See also: </b> <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocMenuEvent>ZocMenuEvent</a></span></font> 
<br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocConnect'></a><b>ZocConnect [&lt;address&gt;]</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Connect to a host via telnet, modem, ssh etc. or read the address to connect 
to from the user if the parameter is omitted. <br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
The connection method will be the one that is active in the current session profile. 
Alternately a connection method can be selected in the script via <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSetDevice>ZocSetDevice</a></span></font> <br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
If the address is an SSH host, you can pass the username and password 
to the host in the form <font class="syntax" color="4060A0" face="Courier New"><span class="syntax">CALL ZocConnect "user:pass@ssh.somedomain.com"</span></font> 
<br> 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
CALL ZocSetDevice "Secure Shell"<br/> 
CALL ZocConnect "harry:alohomora@192.168.1.1:10022"<br/> 
</div></span></font> 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
CALL ZocSetDevice "Telnet"<br/> 
CALL ZocConnect "server.hogwarts.edu"<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
Call ZocTimeout 20<br/> 
x= ZocWait("Login:")<br/> 
IF x=640 THEN SIGNAL waitfailed /* login prompt not received */<br/> 
CALL ZocSend "harry^M"<br/> 
x= ZocWait("Password:")<br/> 
IF x=640 THEN SIGNAL waitfailed /* password prompt not received */<br/> 
CALL ZocSend "secret^M"<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
/* At this point we are logged in */<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
waitfailed:<br/> 
EXIT<br/> 
</div></span></font> 
<br/>&nbsp;<br/>
<b>See also: </b> <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocConnectHostdirEntry>ZocConnectHostdirEntry</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSetDevice>ZocSetDevice</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocDisconnect>ZocDisconnect</a></span></font>, ZocGetInfo("ONLINE") 
<br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocConnectHostdirEntry'></a><b>ZocConnectHostdirEntry &lt;name&gt;</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Makes a connection based on the details of an entry in the ZOC host directory 
(the host directory entry should not have a Login REXX file assigned to it). 
&nbsp;<br/>&nbsp;<br/><b><font color="404060">Example</font>: </b><br/><img src="dummy.gif" alt="nil" width="100" height="6" /><br/><font class="example" color="207030" face="Courier New"><span class="example">CALL ZocConnectHostdirEntry "Webhost 03"</span></font><br/> 
<br/>&nbsp;<br/>
<b>See also: </b> <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocConnect>ZocConnect</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocDisconnect>ZocDisconnect</a></span></font>, ZocGetInfo("ONLINE") 
<br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocCtrlString'></a><b>ZocCtrlString(&lt;text&gt;)</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
This function converts a string containing <a class="link" href=topic-HLP_APXCODES.html>control codes</a> into a string where 
the control codes are converted into their respective values. 
&nbsp;<br/>&nbsp;<br/><b><font color="404060">Example</font>: </b><br/><img src="dummy.gif" alt="nil" width="100" height="6" /><br/><font class="example" color="207030" face="Courier New"><span class="example">crlf= ZocCtrlString("^M^J") /* results in two byte string hex"0D0A" */</span></font><br/> 
<br/>&nbsp;<br/>
<b>See also: </b> <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocCtrlString>ZocCtrlString</a></span></font> 
<br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocDelay'></a><b>ZocDelay [&lt;sec&gt;]</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Wait a given time in seconds or wait 0.2 seconds if the parameter is omitted. 
&nbsp;<br/>&nbsp;<br/><b><font color="404060">Example</font>: </b><br/><img src="dummy.gif" alt="nil" width="100" height="6" /><br/><font class="example" color="207030" face="Courier New"><span class="example">CALL ZocDelay 4.8</span></font><br/> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocDeviceControl'></a><b>ZocDeviceControl &lt;string&gt;</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
This rather arcane command performs an operation that is specific to the 
current connection type (e.g. to return the signal states of the COM 
during a Serial/Direct type connection).<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
Possible control commands for each communication method are described 
in <a class="link" href=topic-HLP_DEVICES.html>ZOC Devices</a>. 
&nbsp;<br/>&nbsp;<br/><b><font color="404060">Example</font>: </b><br/><img src="dummy.gif" alt="nil" width="100" height="6" /><br/><font class="example" color="207030" face="Courier New"><span class="example">state= ZocDeviceControl("GETRS232SIGNALS")</span></font><br/> 
<br/>&nbsp;<br/>
<b>See also: </b> <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSetDevice>ZocSetDevice</a></span></font> 
<br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocDialog'></a><b>ZocDialog &lt;subcommand&gt; [, &lt;parameter&gt;]</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Performs a dialog related function: 
<table><tr><td><img src='dummy.gif' border='0' width='40' height='12' /></td><td></td></tr> 
<tr><td class="pthead2" colspan=2><b><font color="#505060">SHOW</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Shows a user defined dialog window. The 2nd parameter is a combination 
of the the name of the dialog together with the name of the file containing the 
dialog template (the file name is either a fully qualified file name or the name of 
a file located in the same folder as the currently running script file). 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">GET</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Returns the value of one of the dialog elementes (e.g. the text which 
the user had typed into an entry field or the state of a checkbox). 
</table><img src='dummy.gif' border='0' width='40' height='12' /><br/> 
For details about how dialog templates are built, see 
<a class="link" href=topic-HLP_APXRXDIALOG.html>ZocDialog Templates</a>. 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
dlgrc= ZocDialog("SHOW", "MAIN@test.dlg")<br/> 
IF dlgrc=="##OK##" THEN DO<br/> 
&nbsp;&nbsp;SAY ZocDialog("GET", "ED1")<br/> 
&nbsp;&nbsp;SAY ZocDialog("GET", "CB1")<br/> 
&nbsp;&nbsp;SAY ZocDialog("GET", "P1")<br/> 
&nbsp;&nbsp;SAY ZocDialog("GET", "P2")<br/> 
END<br/> 
EXIT<br/> 
</div></span></font> 
<br/>&nbsp;<br/>
<b>See also: </b> <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocAsk>ZocAsk</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocAskPassword>ZocAskPassword</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocMessageBox>ZocMessageBox</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocRequest>ZocRequest</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocRequestList>ZocRequestList</a><dummy></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocDisconnect'></a><b>ZocDisconnect</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Disconnects the current connection. Same as <font class="example" color="207030" face="Courier New"><span class="example">ZocCommand "DISCONNECT"</span></font>. 
&nbsp;<br/>&nbsp;<br/><b><font color="404060">Example</font>: </b><br/><img src="dummy.gif" alt="nil" width="100" height="6" /><br/><font class="example" color="207030" face="Courier New"><span class="example">CALL ZocDisconnect</span></font><br/> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocDownload'></a><b>ZocDownload(&lt;protocol&gt;[:&lt;options&gt;], &lt;file or dir&gt;)</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Download one or more files using a file transfer protocol. <br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
The first parameter 
is the name of a file transfer protocol (as listed in ZOC's 
<a class="link" href=topic-DLG_WIN_OPTS_TRANSFER.html>Options&rarr;Session Profile&rarr;File Transfer</a> 
dialog). <br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
The exact nature of the second parameter varies depending on the 
transfer type (see note below). <br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
For a discussion of the protocol options, please see the ZocUpload 
command further down in this list. <br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
Depending on success or failiure, the function returns the string 
<font class="example" color="207030" face="Courier New"><span class="example">##OK##</span></font> or <font class="example" color="207030" face="Courier New"><span class="example">##ERROR##</span></font> 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
CALL ZocSetSessionOption "TransferAutoStart=no"<br/> 
ret= ZocDownload("ZMODEM", "C:\ZOC\INFILES")<br/> 
IF ret=="##ERROR##" THEN DO<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;CALL ZocBeep 5<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;SAY "Download failed."<br/> 
END<br/> 
</div></span></font> 
<br/>&nbsp;<br/>
<b>Note: </b>The 2nd parameter varies depending on the file transfer type:<br> 
XMODEM: Local destination filename. <br> 
YMODEM: Local destination folder. <br> 
ZMODEM: Local destination folder. <br> 
SCP: Remote source file, e.g. <font class="example" color="207030" face="Courier New"><span class="example">/var/log/somefile.txt</span></font>. 
<br/>&nbsp;<br/>
<b>Note: </b>If you have Auto Transfer enabled in the 
<a class="link" href=topic-DLG_WIN_OPTS_TRANSFER.html>Options&rarr;Session Profile&rarr;File Transfer</a> 
options, and if the remote host starts the transfer before ZOC-REXX processes 
the ZocDownload command, then two download windows will come up. So you need 
to make sure you are issuing ZocDownload() before the host starts or 
make sure that Auto Transfer option is disabled. 
<br/>&nbsp;<br/>
<b>Note: </b>If the file has a name that is set for download to the alternate path 
(in <a class="link" href=topic-DLG_WIN_OPTS_TRANSFER.html>Options&rarr;Session Profile&rarr;File Handling</a>), 
the directory parameter is ignored. 
<br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocDoString'></a><b>ZocDoString(&lt;commandstring&gt;)</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Pass an <a class="link" href=topic-HLP_APXCODES.html>Action Code</a> to ZOC for processing.<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
You can obtain such strings by temporarily mapping something 
to a key via <a class="link" href=topic-DLG_WIN_KEYBOARD.html>Options&rarr;Keyboard Mapping Profiles</a> 
and then copying the result from the key's mapping assistant. 
&nbsp;<br/>&nbsp;<br/><b><font color="404060">Example</font>: </b><br/><img src="dummy.gif" alt="nil" width="100" height="6" /><br/><font class="example" color="207030" face="Courier New"><span class="example">CALL ZocDoString "^EXEC=notepad.exe"</span></font><br/> 
<br/>&nbsp;<br/>
<b>See also: </b> <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocMenuEvent>ZocMenuEvent</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocShell>ZocShell</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSendEmulationKey>ZocSendEmulationKey</a></span></font> <br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocEventSemaphore'></a><b>ZocEventSemaphore(&lt;subcommand&gt;[, &lt;signal-id&gt;])</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
This function can be used to synchronize and exchange signals between multiple 
REXX scripts (it has no use within a single script). To facilitate this, the 
function offers a signaling mechanism with 16 signal slots for which other 
scripts can wait. <br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
Possible <font color="5080A0"><i>&lt;subcommands&gt;</i></font> to the subcomnmand are: 
<table><tr><td><img src='dummy.gif' border='0' width='40' height='12' /></td><td></td></tr> 
<tr><td class="pthead2" colspan=2><b><font color="#505060">RESET</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Reset the signaling state in this skript, clearing thec counter of previous events. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">FIRE</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Send a signal to all running scripts. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">TEST</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Returns the number of received signals since the last reset. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">WAIT</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Wait for a signal. If the semaphore was already fired, the command will 
return immediately, resetting the signal, returning the number of signals which 
happened since the last reset (max 255). Otherwise the function will block and wait 
for a signal, or it will return after a timeout (set via <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocZimeout>ZocZimeout</a></span></font>) with a 
code of 640 (the behavior of this function is very similar to <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocWait>ZocWait</a></span></font>). 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">&lt;signal-id&gt;</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
An optional number [1..15] to access a different signal (default is 0). 
</table><img src='dummy.gif' border='0' width='40' height='12' /><br/> 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
Call ZocEventSemaphore "RESET"<br/> 
/* do some work */<br/> 
...<br/> 
/* wait until another script fires the signal */<br/> 
ret= ZocEventSemaphore "WAIT"<br/> 
IF ret\=640 THEN DO<br/> 
&nbsp;&nbsp;&nbsp;/* signal was received */<br/> 
END<br/> 
</div></span></font> 
<br/>&nbsp;<br/>
<b>See also: </b> <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocTimeout>ZocTimeout</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocWait>ZocWait</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocGlobal>ZocGlobal</a></span></font> 
<br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocFilename'></a><b>ZocFilename(&lt;command&gt;[, &lt;options&gt;])</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
This group of commands offers filename operations. 
<br> 
<table><tr><td><img src='dummy.gif' border='0' width='40' height='12' /></td><td></td></tr> 
<tr><td class="pthead2" colspan=2><b><font color="#505060">COMBINE &lt;path&gt;[, &lt;path2&gt;], &lt;file&gt;</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Combines filename parts 
to a full filename. If &lt;file&gt; is already a fully qualified name, &lt;path&gt; 
and optional &lt;path2&gt; are ignored. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">EXISTS &lt;filename&gt;</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Returns <font class="example" color="207030" face="Courier New"><span class="example">##YES##</span></font> or <font class="example" color="207030" face="Courier New"><span class="example">##NO##</span></font>, depending on if the file exists. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">GETFILE &lt;filename&gt;</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Returns the filename part of a full file descriptor. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">GETPATH &lt;filename&gt;</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Returns the directory part of a full file descriptor. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">GETSIZE &lt;filename&gt;</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Returns the size of a file. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">GETVOLUMELABEL &lt;driveletter&gt;</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Returns the drive label for a drive, e.g. <font class="example" color="207030" face="Courier New"><span class="example">"C:"</span></font> (Windows only). 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">RESOLVE &lt;string&gt;</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Resolves one of ZOC's special file/path placeholders like <font class="example" color="207030" face="Courier New"><span class="example">%ZOCFILES%</span></font> or <font class="example" color="207030" face="Courier New"><span class="example">%USERPROFILE%</span></font> 
(the other filename functions do this automatically). 
</table><img src='dummy.gif' border='0' width='40' height='12' /><br/> 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
workdir= ZocGetInfo("WORKDIR")<br/> 
datadir= ZocFilename("RESOLVE", "%ZOCFILES%");<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
fullfile= ZocAskFilename("Choose File", workdir)<br/> 
file= ZocFilename("GETFILE", fullfile)<br/> 
path= ZocFilename("GETPATH", fullfile)<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
file2= file||".tmp"<br/> 
target= ZocFilename("COMBINE", path, file2)<br/> 
IF ZocFilename("EXISTS", target)=="##YES##" THEN DO<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;CALL ZocMessageBox "Can't overwrite file "||file2<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;EXIT<br/> 
END<br/> 
</div></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocFileCopy'></a><b>ZocFileCopy(&lt;source filename&gt;, &lt;destination&gt;)</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Copy a file to a new destination which can either be a file name 
or folder name.<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
Wildcards like <font class="example" color="207030" face="Courier New"><span class="example">*</span></font> or <font class="example" color="207030" face="Courier New"><span class="example">?</span></font> are not supported int the source file (see <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocListFiles>ZocListFiles</a></span></font>). 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
CALL ZocFileCopy "Z:\SALES.DAT", "Z:\SALES.BAK"<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
ok= ZocFileCopy("C:\DATA\USERFILE.TMP", "C:\BACKUP")<br/> 
IF ok\="##OK##" THEN EXIT<br/> 
</div></span></font> 
<br/>&nbsp;<br/>
<b>See also: </b> <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocFilename>ZocFilename</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocFileDelete>ZocFileDelete</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocFileRename>ZocFileRename</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocListFiles>ZocListFiles</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocShell>ZocShell</a><dummy></span></font> 
<br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocFileDelete'></a><b>ZocFileDelete(&lt;filename&gt;)</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Deletes a file. The filename may not contain wildcards (<font class="example" color="207030" face="Courier New"><span class="example">*</span></font> or <font class="example" color="207030" face="Courier New"><span class="example">?</span></font>, see <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocListFiles>ZocListFiles</a></span></font>).<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
The function returns <font class="example" color="207030" face="Courier New"><span class="example">##OK##</span></font> or <font class="example" color="207030" face="Courier New"><span class="example">##ERROR##</span></font> 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
ok= ZocFileDelete("C:\DATA\USERFILE.TMP")<br/> 
IF ok\="##OK##" THEN EXIT<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
filename= ZocFilename("COMBINE", "%ZOCFILES%", "rexx.log")<br/> 
CALL ZocFileDelete filename<br/> 
</div></span></font> 
<br/>&nbsp;<br/>
<b>See also: </b> <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocFilename>ZocFilename</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocFileCopy>ZocFileCopy</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocFileRename>ZocFileRename</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocListFiles>ZocListFiles</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocShell>ZocShell</a></span></font> 
<br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocFileRename'></a><b>ZocFileRename(&lt;oldname&gt;, &lt;newname&gt;)</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Renames a file. Filenames may not contain wildcards (<font class="example" color="207030" face="Courier New"><span class="example">*</span></font> or <font class="example" color="207030" face="Courier New"><span class="example">?</span></font>, see <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocListFiles>ZocListFiles</a></span></font>). 
Unlike Windows' REN command, the destination can be in a different 
directory or even on a different drive.<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
The function returns <font class="example" color="207030" face="Courier New"><span class="example">##OK##</span></font> or <font class="example" color="207030" face="Courier New"><span class="example">##ERROR##</span></font> 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
ret= ZocFileRename("C:\DATA\USERFILE.TMP", "D:\DATA\USERFILE.TXT")<br/> 
</div></span></font> 
<br/>&nbsp;<br/>
<b>See also: </b> <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocFilename>ZocFilename</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocFileCopy>ZocFileCopy</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocFileDelete>ZocFileDelete</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocListFiles>ZocListFiles</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocShell>ZocShell</a></span></font> 
<br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocGetHostEntry'></a><b>ZocGetHostEntry(&lt;name&gt;, &lt;key&gt;)</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Retrieves the key-value pair for a ZOC host directory entry (see <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSetHostEntry>ZocSetHostEntry</a></span></font> or 
<font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSetSessionOption>ZocSetSessionOption</a></span></font> commands for more information about such key-value pairs). 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
pair= ZocGetHostEntry("ZOC Support BBS", "connectto")<br/> 
PARSE VALUE pair WITH key'="'val'"'<br/> 
CALL ZocConnect val<br/> 
</div></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocGetInfo'></a><b>ZocGetInfo(&lt;what&gt;)</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Depending on the parameter, this function can return various bits of information about 
the current environment and ZOC session. 
<table><tr><td><img src='dummy.gif' border='0' width='40' height='12' /></td><td></td></tr> 
<tr><td class="pthead2" colspan=2><b><font color="#505060">COMPUTERNAME</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
The name of the computer on which ZOC is running. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">CONNECTEDTO</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
The host name, ip, or phone number to which ZOC is connected. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">CURRENTLOGFILENAME</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Current file name for logging. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">CURRENTSCRIPTNAME</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Filename of the main script which is currently executed (this will not return 
sub-scripts which are executed via CALL from inside another script). 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">CURRENTSESSIONPROFILENAME</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
The filename and full path of the current session profile. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">CURSOR-X</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
The x-position of the cursor (starting with zero). 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">CURSOR-Y</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
The y-position of the cursor (starting with zero). 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">DESKTOPSIZE</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
The net size of the Windows/Mac OS X desktop in pixels (excluding taskbar, dock, etc.) 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">DOWNLOADDIR</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
The default drive and directory for downloads. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">EXEDIR</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
The drive and directory in which ZOC has been installed. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">LASTDOWNLOADEDFILE</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
The name and path of the last downloaded file. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">ONLINE</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Information if ZOC is currently connected to a host: 
<font class="example" color="207030" face="Courier New"><span class="example">##YES##</span></font>, <font class="example" color="207030" face="Courier New"><span class="example">##NO##</span></font>, <font class="example" color="207030" face="Courier New"><span class="example">##UNKNOWN##</span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">OSYS</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Returns a string which indicates the operating system 
and OS version under which ZOC is running, e.g. 
<font class="example" color="207030" face="Courier New"><span class="example">Windows XP</span></font>. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">PROCESSID</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
ZOC's system process id. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">SCREENHEIGHT</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Height (number of lines) of the terminal. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">SCREENWIDTH</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Width (number of characters) of the terminal. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">TRANSFER</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Information if a file transfer is currently active: 
<font class="example" color="207030" face="Courier New"><span class="example">##YES##</span></font>, <font class="example" color="207030" face="Courier New"><span class="example">##NO##</span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">UPLOADDIR</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
The default drive and directory for uploads. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">USERID</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
The ID of the currently logged in user. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">VERSION</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
The current ZOC version, e.g. <font class="example" color="207030" face="Courier New"><span class="example">6.24</span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">VERSIONEX</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
The current ZOC version including beta version (if any), e.g. <font class="example" color="207030" face="Courier New"><span class="example">6.24b</span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">WINPOS</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
A string indicating the position and size of the program window on the screen. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">WORKDIR</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
ZOC's working directory (containing host directory, options, etc). 
</table><img src='dummy.gif' border='0' width='40' height='12' /><br/> 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
ver= ZocGetInfo("VERSIONEX")<br/> 
SAY "ZOC "||ver<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
CALL ZocTimeout 30<br/> 
timeout= ZocWait("Password")<br/> 
IF timeout=640 | ZocGetInfo("ONLINE")&lt;&gt;"##YES##" THEN DO<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;SIGNAL PANIC /* disconnected! */<br/> 
END<br/> 
</div></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocGetProgramOption'></a><b>ZocGetProgramOption(&lt;key&gt;)</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Retrieves the key-value pair for a ZOC program option (see 
<font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocGetSessionOption>ZocGetSessionOption</a></span></font> and <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSetProgramOption>ZocSetProgramOption</a></span></font> 
for more info about key-value pars). 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
pair= ZocGetProgramOption("DisconEndProg")<br/> 
PARSE VALUE pair WITH key"="value<br/> 
IF value=="yes" THEN DO<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;SAY "ZOC will terminate after this session."<br/> 
END<br/> 
</div></span></font> 
<br/>&nbsp;<br/>
<b>See also: </b> <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocGetSessionOption>ZocGetSessionOption</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSetSessionOption>ZocSetSessionOption</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSetProgramOption>ZocSetProgramOption</a></span></font> 
<br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocGetScreen'></a><b>ZocGetScreen(&lt;x&gt;,&lt;y&gt;,&lt;len&gt;)</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
The ZocGetScreen() function can be used to return characters that are currently 
displayed in ZOC's terminal window. It returns &lt;len&gt; characters beginning 
from position &lt;x&gt;,&lt;y&gt; (zero based). If it reaches the right margin, it continues 
on the next line without adding a CR or LF. 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
width= ZocGetInfo("SCREENWIDTH")<br/> 
line= ZocGetScreen(0,0, width)<br/> 
IF POS("*", line)=0 THEN DO<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;SAY "There is no '*' character in the first line."<br/> 
END<br/> 
</div></span></font> 
<br/>&nbsp;<br/>
<b>See also: </b> ZocGetInfo("CURSOR-X"), ZocGetInfo("CURSOR-Y") 
<br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocGetSessionOption'></a><b>ZocGetSessionOption(&lt;key&gt;)</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Retrieves the key-value pair for a ZOC option from the session 
profile (see the <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSetSessionOption>ZocSetSessionOption</a></span></font> command for more details). 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
pair= ZocGetSessionOption("Beep")<br/> 
PARSE VALUE pair WITH key"="value<br/> 
IF value=="no" THEN DO<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;SAY "The beep option is turned off."<br/> 
END<br/> 
</div></span></font> 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
pair= ZocGetSessionOption("EnqString")<br/> 
PARSE VALUE pair WITH key'="'value'"'<br/> 
SAY "The configured answer to enq is: "||value<br/> 
</div></span></font> 
<br/>&nbsp;<br/>
<b>See also: </b> <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSetSessionOption>ZocSetSessionOption</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocGetProgramOption>ZocGetProgramOption</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSetProgramOption>ZocSetProgramOption</a></span></font> 
<br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocGlobal'></a><b>ZocGlobal(&lt;operation&gt;, [&lt;options&gt;])</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
This group of functions allows permanent storage of values in a file based 
data pool. This can be used to remember values across various script runs 
(the operations are atomic and they are protected against concurrent access).<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
Possible operations are: 
<table><tr><td><img src='dummy.gif' border='0' width='40' height='12' /></td><td></td></tr> 
<tr><td class="pthead2" colspan=2><b><font color="#505060">SELECT &lt;name&gt;</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Select a different global pool. The name will be used to 
create a file name in the form <font class="example" color="207030" face="Courier New"><span class="example">&lt;name&gt;Global.ini</span></font> in the user data folder 
or it can point to a different location, e.g. <font class="example" color="207030" face="Courier New"><span class="example">C:\data\mypool</span></font> 
(which will then also belcome <font class="example" color="207030" face="Courier New"><span class="example">mypoolGlobal.ini</span></font>). 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">INIT</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Clear all values in the global space. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">GET &lt;name&gt;</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Returns the value with the given name. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">PUT &lt;name&gt;, &lt;value&gt;</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Stores a value in the storage pool under a given name. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">SET &lt;name&gt;, &lt;value&gt;</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Same as PUT 
</table><img src='dummy.gif' border='0' width='40' height='12' /><br/> 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
CALL ZocGlobal "SELECT", "MyValStore"<br/> 
x= ZocGlobal("GET", "LASTX")<br/> 
...<br/> 
CALL ZocGlobal "SET", "LASTX", x<br/> 
</div></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocKeyboard'></a><b>ZocKeyboard(&lt;command&gt; [, &lt;timeout&gt;])</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
This function allows a REXX script to read keystrokes from the terminal 
window. It supports the subcommands <font class="syntax" color="4060A0" face="Courier New"><span class="syntax">LOCK</span></font>, <font class="syntax" color="4060A0" face="Courier New"><span class="syntax">UNLOCK</span></font> and <font class="syntax" color="4060A0" face="Courier New"><span class="syntax">GETNEXTKEY</span></font><br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
<table><tr><td><img src='dummy.gif' border='0' width='40' height='12' /></td><td></td></tr> 
<tr><td class="pthead2" colspan=2><b><font color="#505060">LOCK</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Lock the keyboard and prevent user input. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">UNLOCK</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Unlock the keyboard from a previous <font class="syntax" color="4060A0" face="Courier New"><span class="syntax">LOCK</span></font> state. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">GETNEXTKEY</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Wait for the next keystroke and return it. You can also specify a 
timeout in seconds and if successful, GETNEXTKEY will 
return a string in the form <font class="syntax" color="4060A0" face="Courier New"><span class="syntax">char|scancode|shift|ctrl|alt</span></font>.<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
<font class="example" color="207030" face="Courier New"><span class="example">char:</span></font> two byte hex number representing the ascii code of the key.<br> 
<font class="example" color="207030" face="Courier New"><span class="example">scancode:</span></font> The physical scan code from the keyboard (the scan code can be 
used to identify functional keys such home, del, f1, f2, etc.).<br> 
<font class="example" color="207030" face="Courier New"><span class="example">shift</span></font>, <font class="example" color="207030" face="Courier New"><span class="example">ctrl</span></font> and <font class="example" color="207030" face="Courier New"><span class="example">alt</span></font> are either <font class="example" color="207030" face="Courier New"><span class="example">0</span></font> or 
<font class="example" color="207030" face="Courier New"><span class="example">1</span></font> indicating if they were held down when the primary key was pressed.<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
</table><img src='dummy.gif' border='0' width='40' height='12' /><br/> 
The example below shows how the subcommands are used and how the possible 
result can be split into its parts and displayed in a user friendly form.<br> 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
CALL ZocKeyboard "UNLOCK"<br/> 
ret= ZocKeyboard("GETNEXTKEY", 30)<br/> 
PARSE VALUE ret WITH hexkey"|"scan"|"shift"|"ctrl"|"alt<br/> 
key= X2C(hexkey)<br/> 
SAY "You pressed hex/key: "hexkey"/"key<br/> 
SAY "Scan code: "scan<br/> 
SAY "Shift/Ctrl/Alt states: "shift"/"ctrl"/"alt<br/> 
</div></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocLastLine'></a><b>ZocLastLine()</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
This is a function and returns the last line of text that was received from the point 
the last <font color="5080A0"><i>ZocWait/ZocWaitMux/ZocWaitLine</i></font> command was issued to the point when it 
successfully returned<br> 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
CALL ZocSend "ATZ^M"<br/> 
timeout= ZocWaitMux("OK", "ERROR")<br/> 
IF timeout\=640 & THEN DO<br/> 
&nbsp;IF ZocLastLine()\="OK" THEN SIGNAL error<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;CALL ZocConnect "555 3456"<br/> 
END<br/> 
</div></span></font> 
<br/>&nbsp;<br/>
<b>Note: </b>In many cases, using <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocReceiveBuf>ZocReceiveBuf</a></span></font> instead will be the more flexible choice. 
<br/>&nbsp;<br/>
<b>Note: </b>Also see the examples in the description for <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocWaitLine>ZocWaitLine</a></span></font> 
<br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocListFiles'></a><b>ZocListFiles(&lt;path\mask&gt; [, &lt;separator&gt;])</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
The ZocListFiles function will retrieve a list of filenames for a directory.<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
The first parameter is a directory name and wildcard mask (e.g. 
<font class="example" color="207030" face="Courier New"><span class="example">"c:\data\*.*"</span></font>). <br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
The function will return a string which contains 
the number of files and the file names separated by space characters, e.g. 
<font class="example" color="207030" face="Courier New"><span class="example">"3 download.zip sales.txt foobar.fil"</span></font> 
<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
This allows easy access to the parts of the string via REXX's WORD function 
(see example below). If you expect filenames to contain space 
characters you can provide a different list separator as the second parameter. 
E.g. a separator of "|" will return the string 
<font class="example" color="207030" face="Courier New"><span class="example">"3 download.zip|sales.txt|foobar.pdf"</span></font>. In this case you can 
use <font class="example" color="207030" face="Courier New"><span class="example">ZocString("PART", purelist, i, "|")</span></font> to extract the file names. <br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
<b>Note:</b> The number of filenames returned is limited to 128 and the 
maximum length of the total string returned is 4096.<br> 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
files= ZocListFiles("C:\TEMP\*")<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
howmany= WORD(files, 1)<br/> 
SAY "Number of Files:" howmany<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
purelist= SUBSTR(files, LENGTH(howmany)+2)<br/> 
DO i=1 TO howmany<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;SAY "File " i "=" WORD(purelist, i)<br/> 
END<br/> 
</div></span></font> 
<br/>&nbsp;<br/>
<b>See also: </b> <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocFilename>ZocFilename</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocGetFilename>ZocGetFilename</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocGetFilenames>ZocGetFilenames</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocGetFolderName>ZocGetFolderName</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocString>ZocString</a></span></font> 
<br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocLoadKeyboardProfile'></a><b>ZocLoadKeyboardProfile [&lt;zkyfile&gt;]</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Loads and activates a keyboard profile (*.zky file). 
&nbsp;<br/>&nbsp;<br/><b><font color="404060">Example</font>: </b><br/><img src="dummy.gif" alt="nil" width="100" height="6" /><br/><font class="example" color="207030" face="Courier New"><span class="example">CALL ZocLoadKeyboardProfile "Alternate.zky"</span></font><br/> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocLoadSessionProfile'></a><b>ZocLoadSessionProfile &lt;optsfile&gt;</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Loads and activates a session profile file (*.zoc). 
&nbsp;<br/>&nbsp;<br/><b><font color="404060">Example</font>: </b><br/><img src="dummy.gif" alt="nil" width="100" height="6" /><br/><font class="example" color="207030" face="Courier New"><span class="example">CALL ZocLoadSessionProfile "Zoc4Linux.zoc"</span></font><br/> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocLoadTranslationProfile'></a><b>ZocLoadTranslationProfile [&lt;ztrfile&gt;]</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Loads and activates a character translation profile (*.ztr). 
&nbsp;<br/>&nbsp;<br/><b><font color="404060">Example</font>: </b><br/><img src="dummy.gif" alt="nil" width="100" height="6" /><br/><font class="example" color="207030" face="Courier New"><span class="example">CALL ZocLoadTranslationProfile "7bitgerman.ztr"</span></font><br/> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocMath'></a><b>ZocMath(&lt;function&gt;, &lt;arg&gt;])</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
ZocMath calculates the math function based on the 2nd argument. Valid 
functions are <font color="5080A0"><i>sin</i></font>, <font color="5080A0"><i>cos</i></font>, <font color="5080A0"><i>tan</i></font>, 
<font color="5080A0"><i>asin</i></font>, <font color="5080A0"><i>acos</i></font>, <font color="5080A0"><i>sqrt</i></font>, <font color="5080A0"><i>todeg</i></font>, <font color="5080A0"><i>torad</i></font>. 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
angle = 270<br/> 
anglerad = ZocMath("torad", angle)<br/> 
sinresult = ZocMath("sin", anglerad)<br/> 
</div></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocMenuEvent'></a><b>ZocMenuEvent(&lt;menu text&gt; [, &lt;file&gt;])</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Perform a function from the ZOC menu. The <font color="5080A0"><i>&lt;menu text&gt;</i></font> is a text that matches 
an entry in the ZOC menu. The <font color="5080A0"><i>&lt;file&gt;</i></font> parameter is an optional file name which 
some menu events accept rather than prompting the user for a file. 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
CALL ZocMenuEvent "Paste (no line breaks)"<br/> 
CALL ZocMenuEvent "Edit REXX Script", "test.zrx"<br/> 
</div></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocMessageBox'></a><b>ZocMessageBox(&lt;text&gt; [, &lt;mode&gt;])</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Display a message box. Normally an informational message window with an OK 
button (mode 0) is shown. Mode 1 shows an error message with an OK button. 
Mode 2 shows a message with a YES and NO button. The return value 
is either <font class="example" color="207030" face="Courier New"><span class="example">##OK##</span></font> or <font class="example" color="207030" face="Courier New"><span class="example">##YES##</span></font> or <font class="example" color="207030" face="Courier New"><span class="example">##NO##</span></font>. 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
CALL ZocMessageBox "Connect Failed!", 1<br/> 
ret= ZocMessageBox("Try again?", 2)<br/> 
IF ret=="##YES##" THEN DO<br/> 
&nbsp;&nbsp;&nbsp;...<br/> 
END<br/> 
</div></span></font> 
<br/>&nbsp;<br/>
<b>See also: </b> <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocAsk>ZocAsk</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocAskPassword>ZocAskPassword</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocRequest>ZocRequest</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocRequestList>ZocRequestList</a></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocNotify'></a><b>ZocNotify &lt;text&gt;</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Display a small floating message at the center of the window. 
&nbsp;<br/>&nbsp;<br/><b><font color="404060">Example</font>: </b><br/><img src="dummy.gif" alt="nil" width="100" height="6" /><br/><font class="example" color="207030" face="Courier New"><span class="example">CALL ZocNotify "Hello World!"</span></font><br/> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocPlaySound'></a><b>ZocPlaySound &lt;file&gt;</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Plays a .WAV file. 
&nbsp;<br/>&nbsp;<br/><b><font color="404060">Example</font>: </b><br/><img src="dummy.gif" alt="nil" width="100" height="6" /><br/><font class="example" color="207030" face="Courier New"><span class="example">CALL ZocPlaySound "ka-ching.wav"</span></font><br/> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocReceiveBuf'></a><b>ZocReceiveBuf(&lt;buffer size&gt;)</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
This function makes ZOC collect parts of a session in a memory buffer 
and returns the previous buffer's contents (if any) as a string. <br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
Initially the buffer has a size of zero, which means that no data 
is collected. To start data collection you need to call the function with 
a parameter indicating the size of the next receive buffer. After that, 
incoming data is added to the buffer until either the buffer is full or 
until the function is called again. Calling ZocReceiveBuf again will 
retrieve the buffer's content, reset the content and set a new size 
for the buffer.<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
A sequence of calls to ZocReceiveBuf in order to retrieve text from a 
database will look like this: 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
/* make a receive buffer of 256 bytes */<br/> 
CALL ZocTimeout 60<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
CALL ZocReceiveBuf 256<br/> 
CALL ZocSend "read abstract^M"<br/> 
CALL ZocWait "Command&gt;"<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
/* get the result from the read command and */<br/> 
/* make a larger buffer to hold the result of */<br/> 
/* a subsequent command. */<br/> 
abst= ZocReceiveBuf(4096)<br/> 
CALL ZocSend "read contents^M"<br/> 
CALL ZocWait "Command&gt;"<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
/* get the content and discontinue buffering */<br/> 
cont= ZocReceiveBuf(0)<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
/* At this point, both variables (abst and cont) will start<br/> 
with the word "read" and end with the character "&gt;", containing<br/> 
whatever data was received between the command and next prompt. */<br/> 
</div></span></font> 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
/* read the remote environment variables and extract the TERM= value */<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
Call ZocReceiveBuf 2048<br/> 
Call ZocSend "set^M"<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
/* you will need to wait for the your own prompt here */<br/> 
Call ZocWait "PROMPT: ~username$"<br/> 
data= ZocReceiveBuf(0)<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
/* google for "REXX PARSE COMMAND" to get more details<br/> 
&nbsp;&nbsp;on the PARSE command which is used to extract the data */<br/> 
PARSE VALUE data WITH ."TERM="term .<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
SAY "The remote term setting is " term<br/> 
</div></span></font> 
<br/>&nbsp;<br/>
<b>Note: </b>If executed via DDE, the ZocReceiveBuf command must be sent as 
a DdeRequest (rather than DdeExecute) 
<br/>&nbsp;<br/>
<b>Note: </b>See also <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocWaitForSeq>ZocWaitForSeq</a></span></font> and ZocString("LINE" ...) <br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocRegistry'></a><b>ZocRegistry(&lt;subcommand&gt;[, &lt;options&gt;])</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
This group of commands allows access to the Windows registry. 
<table><tr><td><img src='dummy.gif' border='0' width='40' height='12' /></td><td></td></tr> 
<tr><td class="pthead2" colspan=2><b><font color="#505060">OPEN &lt;basekey&gt;, &lt;name&gt;</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Return a &lt;hkey&gt; handle for access to 
a part of the registry. Basekey can be <font class="syntax" color="4060A0" face="Courier New"><span class="syntax">HKEY_CURRENT_USER</span></font> or 
<font class="syntax" color="4060A0" face="Courier New"><span class="syntax">HKEY_LOCAL_MACHINE</span></font> <br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
OPEN returns a hkey value which can be used to read/write this part of the registry. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">WRITE &lt;hkey&gt;, &lt;value&gt;, &lt;data&gt;</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Writes &lt;data&gt; to the part of the 
registry which is associated with &lt;hkey&gt;. If &lt;data&gt; is provided in the 
form <font class="syntax" color="4060A0" face="Courier New"><span class="syntax">"DWORD:nnnn"</span></font> the decimal value nnnn will be stored as REG_DWORD, 
otherwise data will be stored as REG_SZ (string). 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">READ &lt;hkey&gt;, &lt;value&gt;</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Read a value from the registry part &lt;hkey&gt;. 
If the registry value is in REG_DWORD format, the command will return <font class="syntax" color="4060A0" face="Courier New"><span class="syntax">"DWORD:n"</span></font> 
otherwise the string from the registry will be returned. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">ENUM &lt;hkey&gt;, &lt;n&gt;</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Returns the &lt;n&gt;th value name from &lt;hkey&gt; or 
<font class="example" color="207030" face="Courier New"><span class="example">##ERROR##</span></font> if no such value exists. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">CLOSE &lt;hkey&gt;</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Ends access to &lt;hkey&gt;. 
</table><img src='dummy.gif' border='0' width='40' height='12' /><br/> 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
hk= ZocRegistry("OPEN", "HKEY_CURRENT_USER", "Software\Emtec\ZOC7")<br/> 
IF hk=="##ERROR##" THEN EXIT<br/> 
CALL ZocRegistry "WRITE", hk, "Test01", "Hello World"<br/> 
CALL ZocRegistry "WRITE", hk, "Test02", "DWORD:1"<br/> 
homepath= ZocRegistry("READ", hk, "%ZOC%")<br/> 
SAY "ZOC installed in "||homepath<br/> 
i= 0<br/> 
DO FOREVER<br/> 
&nbsp;x= ZocRegistry("ENUM", hk, i)<br/> 
&nbsp;IF x=="##ERROR##" THEN LEAVE<br/> 
&nbsp;i= i+1<br/> 
&nbsp;SAY "Value named "||x<br/> 
END<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
CALL ZocRegistry "CLOSE", hk<br/> 
EXIT<br/> 
</div></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocRequest'></a><b>ZocRequest(&lt;title&gt;, &lt;opt1&gt; [, &lt;opt2&gt; [, &lt;opt3&gt;]])</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Displays a dialog window with options and returns a string containing the 
selected option. 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
answer= ZocRequest("What do you want?", "Milk", "Honey")<br/> 
IF answer=="Milk" THEN DO<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;...<br/> 
END<br/> 
</div></span></font> 
<br/>&nbsp;<br/>
<b>See also: </b> <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocAsk>ZocAsk</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocAskPassword>ZocAskPassword</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocMessageBox>ZocMessageBox</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocRequestList>ZocRequestList</a></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocRequestList'></a><b>ZocRequestList(&lt;title&gt;, &lt;opt1&gt; [, ...]])</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Displays a dialog window with a list of options and returns 
the index of the selected option (or -1 for Cancel). If only one 
option is passed to the function, it is considered as a list of 
choices separated by vertical bars. 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
answer= ZocRequestList("Please select!", "Beer", "Wine", "Whiskey", "Liquor")<br/> 
IF answer=3 THEN DO<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;...<br/> 
END<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
answer= ZocRequestList("Please select!", "Beer|Wine|Whiskey|Liquor")<br/> 
IF answer=3 THEN DO<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;...<br/> 
END<br/> 
</div></span></font> 
<br/>&nbsp;<br/>
<b>See also: </b> <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocAsk>ZocAsk</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocAskPassword>ZocAskPassword</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocMessageBox>ZocMessageBox</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocRequest>ZocRequest</a></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocRespond'></a><b>ZocRespond &lt;text1&gt; [, &lt;text2&gt;]</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Send <font class="syntax" color="4060A0" face="Courier New"><span class="syntax">text2</span></font> whenever <font class="syntax" color="4060A0" face="Courier New"><span class="syntax">text2</span></font> is received while REXX is processing a 
ZocDelay or ZocWait command. <br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
A maximum of 64 Respond commands can be active simultaneously. 
&lt;text1&gt; must not contain carriage returns or line feeds.<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
If <font class="syntax" color="4060A0" face="Courier New"><span class="syntax">text2</span></font> is omitted or empty the response command for &lt;text1&gt; is cleared. 
If <font class="syntax" color="4060A0" face="Courier New"><span class="syntax">text1</span></font> is empty ("") all responses are cleared. 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
/* Wait for 'Command' and auto-skip all possibly prompts in between */<br/> 
CALL ZocRespond "Enter", "^M"<br/> 
CALL ZocRespond "More", "^M"<br/> 
timeout= ZocWait("Command")<br/> 
/* Clear responders */<br/> 
CALL ZocRespond "Enter"<br/> 
CALL ZocRespond "More"<br/> 
</div></span></font> 
<br> 
The above example waits until the text <font class="example" color="207030" face="Courier New"><span class="example">Command</span></font> is received. While 
waiting, all <font class="example" color="207030" face="Courier New"><span class="example">Enter</span></font> and <font class="example" color="207030" face="Courier New"><span class="example">More</span></font> prompts are answered 
automatically by sending Enter. After the Wait is satisfied, the respond 
commands are cancelled.<br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocSaveSessionProfile'></a><b>ZocSaveSessionProfile [&lt;optsfile&gt;]</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Save the current session profile to file. If the <font color="5080A0"><i>&lt;optsfile&gt;</i></font> 
parameter is omitted, ZOC will ask the user for a filename. 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
CALL ZocSetSessionOption "JumpScroll=3"<br/> 
CALL ZocSaveSessionProfile "Fastscroll.zoc"<br/> 
</div></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocSend'></a><b>ZocSend &lt;text&gt;</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Sends the given text to the remote host. <br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
Internally the text sending is processed as a series keystrokes rather than sending it 
directly through the low level communication channel. The send speed is based on the text 
sending option int <a class="link" href=topic-DLG_WIN_OPTS_TEXTSEND.html>Options&rarr;Session Profile&rarr;Text Sending</a>. 
If you need a faster, more direct version of this command, please use ZocSendRaw<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
Also, if the text contains control codes (e.g. <font class="example" color="207030" face="Courier New"><span class="example">^M</span></font> for Enter), are replaced with their 
respective values. For nearly all emulations 
these control codes are based on the <a class="link" href=topic-HLP_APXCODES.html>Control Codes Table</a> Exceptions 
are the TN3270 and TN5250 emulations, where <font class="example" color="207030" face="Courier New"><span class="example">^M</span></font> is interpreted as <font color="5080A0"><i>Newline/FieldExit</i></font>, 
<font class="example" color="207030" face="Courier New"><span class="example">^I</span></font> as <font color="5080A0"><i>Tab</i></font> and <font class="example" color="207030" face="Courier New"><span class="example">^Z</span></font> as <font color="5080A0"><i>Transmit/Enter</i></font><br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
/* send JOE USER&lt;enter&gt;*/<br/> 
CALL ZocSend "JOE USER^M"<br/> 
</div></span></font> 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
/* Unix login Sequence */<br/> 
CALL ZocWait "login:"<br/> 
CALL ZocSend "harry^M"<br/> 
CALL ZocWait "password:"<br/> 
CALL ZocSend "alohomora^M"<br/> 
</div></span></font> 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
/* 3270/5250 example */<br/> 
CALL ZocSend "Freddie"<br/> 
CALL ZocSendEmulationKey "NewLine"<br/> 
CALL ZocSend "Elm Street"<br/> 
CALL ZocSendEmulationKey "Enter"<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
/* 3270/5250 same as above */<br/> 
CALL ZocSend "Freddie^MElm Street^Z"<br/> 
</div></span></font> 
<br/>&nbsp;<br/>
<b>See also: </b> <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSendRaw>ZocSendRaw</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSendEmulationKey>ZocSendEmulationKey</a></span></font><br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocSendEmulationKey'></a><b>ZocSendEmulationKey &lt;keyname&gt;</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Send the code that represents a special key in the current terminal 
emulation, e.g. send <font color="5080A0"><i>F17</i></font> from a VT220 emulation or <font color="5080A0"><i>Attn</i></font> unter TN3270.<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
The key names are described in the <a class="link" href=topic-HLP_APXEMUKEYS.html>Key Names Appendix</a>. 
&nbsp;<br/>&nbsp;<br/><b><font color="404060">Example</font>: </b><br/><img src="dummy.gif" alt="nil" width="100" height="6" /><br/><font class="example" color="207030" face="Courier New"><span class="example">CALL ZocSendEmulationKey "f17" /* Send F17 based on current emulation */</span></font><br/> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocSendRaw'></a><b>ZocSendRaw &lt;datastring&gt;</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
This command sends the data from datastring in untranslated form. 
The command does not translate control sequences like <font class="example" color="207030" face="Courier New"><span class="example">^M</span></font>. 
If you need to send such codes, you will have to use the REXX string 
functions like X2C(&lt;hexcode&gt;) or ZocCtrlString to create a corresponding 
character values (e.g. X2C(0D) for Enter).<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
ZocSendRaw may be useful if you want to send binary data to a host. 
For example, if you want to send <font class="example" color="207030" face="Courier New"><span class="example">42 01 00 05 41 43 (hex)</span></font> through 
the communication channel, you can do this as in the 2nd part of the example below. 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
CALL ZocSendRaw "Login"||X2C(0d) /* Login&lt;enter&gt; */<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
/* Four times the same result: */<br/> 
CALL ZocSendRaw X2C(420100054143)<br/> 
CALL ZocSendRaw "B"||X2C(01)||X2C(00)||X2C(05)||"AC"<br/> 
CALL ZocSendRaw ZocCtrlString("B^A^@^EAC")<br/> 
CALL ZocSend "B^A^@^EAC"<br/> 
</div></span></font> 
<br/>&nbsp;<br/>
<b>See also: </b> <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSend>ZocSend</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSendEmulationKey>ZocSendEmulationKey</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocCtrlString>ZocCtrlString</a></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocSessionTab'></a><b>ZocSessionTab(&lt;subcommand&gt;, &lt;parameters&gt;)</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
This function allows a REXX script to access or manipulate session tabs. The subcommand 
defines the action, the parameters depend on the subcommand. 
<table><tr><td><img src='dummy.gif' border='0' width='40' height='12' /></td><td></td></tr> 
<tr><td class="pthead2" colspan=2><b><font color="#505060">CLOSEATEXIT</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Close the current session tab when the script exits.<br> 
&nbsp;<br/><b><font color="404060">Example</font>: &nbsp;</b><font class="example" color="207030" face="Courier New"><span class="example">CALL ZocSessionTab "CLOSEATEXIT"</span></font><br/> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">CLOSETAB</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Close the session tab with the given index (zero for the leftmost tab or -1 for the current tab).<br> 
&nbsp;<br/><b><font color="404060">Example</font>: &nbsp;</b><font class="example" color="207030" face="Courier New"><span class="example">CALL ZocSessionTab "CLOSETAB", 2</span></font><br/> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">GETCOUNT</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Returns the number of session tabs.<br> 
&nbsp;<br/><b><font color="404060">Example</font>: &nbsp;</b><font class="example" color="207030" face="Courier New"><span class="example">howmany= ZocSessionTab("GETCOUNT")</span></font><br/> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">GETCURRENTINDEX</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Returns the index of the tab in which this script is running.<br> 
&nbsp;<br/><b><font color="404060">Example</font>: &nbsp;</b><font class="example" color="207030" face="Courier New"><span class="example">myidx= ZocSessionTab("GETCURRENTINDEX")</span></font><br/> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">GETINDEXBYNAME, &lt;name&gt;</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Returns the index of the first tab that has a given title or -1 if none was found.<br> 
&nbsp;<br/><b><font color="404060">Example</font>: &nbsp;</b><font class="example" color="207030" face="Courier New"><span class="example">srvidx= ZocSessionTab("GETTINDEXBYNAME", "My Server")</span></font><br/> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">GETNAME, &lt;index&gt;</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Return the name of the tab with a given index (zero for the leftmost tab) from 
the 1st parameter. An index of -1 refers to the session in which the script is running.<br> 
&nbsp;<br/><b><font color="404060">Example</font>: &nbsp;</b><font class="example" color="207030" face="Courier New"><span class="example">name= ZocSessionTab("GETNAME", -1)</span></font><br/> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">NEWSESSION, &lt;title&gt;, &lt;activate&gt;, &lt;sessionprofile&gt;[, &lt;connectto&gt;, &lt;script&gt;]</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2"> 
Create a new session and return the new session's index.<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
<b>Parameters:</b> 
<br> 
<font class="syntax" color="4060A0" face="Courier New"><span class="syntax">&lt;title&gt;</span></font>: A string naming the tab.<br> 
<font class="syntax" color="4060A0" face="Courier New"><span class="syntax">&lt;activate&gt;</span></font>: 0 or 1 depending on if the new tab should be in the background or active.<br> 
<font class="syntax" color="4060A0" face="Courier New"><span class="syntax">&lt;sessionprofile&gt;</span></font>: name of a session profile (e.g. <font class="example" color="207030" face="Courier New"><span class="example">MyProfile.zoc</span></font>). or <font class="example" color="207030" face="Courier New"><span class="example">##NULL##</span></font> for default.<br> 
<font class="syntax" color="4060A0" face="Courier New"><span class="syntax">&lt;connectto&gt;</span></font>: A string as described with the <a class="link" href=topic-HLP_START_PARM.html>/CONNECT command line parameters</a>, or a 
string prefixed with <font class="example" color="207030" face="Courier New"><span class="example">CALL:</span></font> followed by the name of an entry in the host directory, or 
<font class="example" color="207030" face="Courier New"><span class="example">##NULL##</span></font> for none.<br> 
<font class="syntax" color="4060A0" face="Courier New"><span class="syntax">&lt;script&gt;</span></font>: The name of a script file to run in the new tab..<br> 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
idx1= ZocSessionTab("NEWSESSION", "Test 1", 0, "SSHProfile.zoc", "SSH!Harry:alohomora@ssh.hogwarts.edu")<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
idx2= ZocSessionTab("NEWSESSION", "Test 2", 1, "##NULL##", "##NULL##", "test.zrx")<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
idx3= ZocSessionTab("NEWSESSION", "Test 3", 1, "##NULL##", "CALL:My Server")<br/> 
CALL ZocSessionTab "SETCOLOR", idx3, 5<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
idx4= ZocSessionTab("NEWSESSION", "Test 4", 1, "Standard.zoc", "TELNET!smtp.hogwarts.edu:25", "test.zrx")<br/> 
</div></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">MENUEVENT, &lt;index&gt;, &lt;menu&gt;</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Performs a command from the ZOC menu in a different 
session. The &lt;index&gt; parameter indicates the session (see the description of the &lt;index&gt; parameter 
for GETNAME), the &lt;menu&gt; parameter is the same as for ZocMenuEvent.<br> 
&nbsp;<br/><b><font color="404060">Example</font>: &nbsp;</b><font class="example" color="207030" face="Courier New"><span class="example">CALL ZocSessionTab "MENUEVENT", idx, "Disconnect"</span></font><br/> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">RUNSCRIPT, &lt;index&gt;, &lt;title&gt;</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Starts a script in a different session. 
The &lt;index&gt; parameter indicates the session (see description of the &lt;index&gt; parameter for GETNAME). 
Please note that this will not work for sessions which already have a script running 
(including the session/script which issues the ZocSessionTab("RUNSCRIPT", ...) command.<br> 
&nbsp;<br/><b><font color="404060">Example</font>: &nbsp;</b><font class="example" color="207030" face="Courier New"><span class="example">CALL ZocSessionTab "RUNSCRIPT", newidx, "configure.zrx"</span></font><br/> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">SEND, &lt;index&gt;, &lt;text&gt;</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Sends text to the session with the given index (similar to 
using the ZocSend command). <br> 
The &lt;index&gt; parameter indicates the session (for details see description of the &lt;index&gt; parameter for GETNAME). 
&nbsp;<br/><b><font color="404060">Example</font>: &nbsp;</b><font class="example" color="207030" face="Courier New"><span class="example">CALL ZocSessionTab "SEND", 2, "exit^M"</span></font><br/> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">SETCOLOR, &lt;index&gt;, &lt;color&gt;</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Sets the color of the tab with a given index. 
The &lt;index&gt; parameter indicates the session (for details see the description of the &lt;index&gt; parameter for GETNAME). 
The color is a number between 0 and 7.<br> 
&nbsp;<br/><b><font color="404060">Example</font>: &nbsp;</b><font class="example" color="207030" face="Courier New"><span class="example">CALL ZocSessionTab "SETCOLOR", -1, 4</span></font><br/> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">SETBLINKING, &lt;index&gt;, &lt;blinkflag&gt;</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Activates or deactivates the blinking for the tab 
with a given index. The &lt;index&gt; parameter indicates the session (for details see the description of the &lt;index&gt; 
parameter for GETNAME). The &lt;blinkflag&gt; is either <font color="5080A0"><i>1</i></font> or <font color="5080A0"><i>0</i></font>.<br> 
&nbsp;<br/><b><font color="404060">Example</font>: &nbsp;</b><font class="example" color="207030" face="Courier New"><span class="example">CALL ZocSessionTab "SETBLINKING", -1, 1</span></font><br/> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">SETNAME, &lt;index&gt;, &lt;title&gt;</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Sets the name of the tab with a given index. 
The &lt;index&gt; parameter indicates the session (for details see the description of the &lt;index&gt; parameter for GETNAME).<br> 
&nbsp;<br/><b><font color="404060">Example</font>: &nbsp;</b><font class="example" color="207030" face="Courier New"><span class="example">CALL ZocSessionTab "SETNAME", -1, "This Session"</span></font><br/> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">SWITCHTO, &lt;index&gt;</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Activate the tab with a given index. 
The &lt;index&gt; parameter indicates the session(for details see the description of the &lt;index&gt; parameter for GETNAME).<br> 
&nbsp;<br/><b><font color="404060">Example</font>: &nbsp;</b><font class="example" color="207030" face="Courier New"><span class="example">CALL ZocSessionTab "SWITCHTO", 2</span></font><br/> 
</table><img src='dummy.gif' border='0' width='40' height='12' /><br/> 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
/* ZocSessionTab sample: send a text to all tabs */<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
text= ZocAsk("Command to send to all tabs:")<br/> 
IF text\="##CANCEL##" THEN DO<br/> 
&nbsp;&nbsp;n= ZocSessionTabs("GETCOUNT")<br/> 
&nbsp;&nbsp;SAY n<br/> 
&nbsp;&nbsp;DO i=0 TO n-1<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;name= ZocSessionTabs("GETNAME", i)<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;CALL ZocSessionTabs "SEND", i, text||"^M"<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;SAY "Sent "||text||" to "||name<br/> 
&nbsp;&nbsp;END<br/> 
END<br/> 
</div></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocSetAuditLogname'></a><b>ZocSetAuditLogname &lt;filename&gt;</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Set the file name for the audit log (a logfile that can not be 
turned off by the user, also see the setting in the ADMIN.INI file 
in the program folder) or turn off audit logging with "" (empty string) 
as a filename.<br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocSetAutoAccept'></a><b>ZocSetAutoAccept 1|0</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
For those connection types that support it (e.g. Telnet), make the communication 
method accept incoming connections. 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
CALL ZocSetDevice "Telnet"<br/> 
CALL ZocSetAutoAccept 1 /* accept calls */<br/> 
</div></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocSetDevice'></a><b>ZocSetDevice &lt;name&gt; [, &lt;commparm-string&gt;]</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Change the connection type (communication device). The name must be one of the names 
from the list in <a class="link" href=topic-DLG_WIN_OPTS_DEVICE.html>Options&rarr;Session Profile&rarr;Connection Type</a>.<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
The optional commparm-string contains options, which can further tweak the operation of that connection 
(e.g. setting Telnet-specific options, see <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSetDeviceOpts>ZocSetDeviceOpts</a></span></font> for information about 
how to obtain a commparm-string). If the comm parameters are omitted, ZOC uses the options which 
are set for the connection type in the currently active session profile. 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
CALL ZocSetDevice "Telnet"<br/> 
CALL ZocConnect "bbs.channel1.com"<br/> 
</div></span></font> 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
CALL ZocSetDevice "SERIAL/MODEM", "[1]COM3:57600-8N1|9|350"<br/> 
</div></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocSetDeviceOpts'></a><b>ZocSetDeviceOpts &lt;parameter-string&gt;</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
This is a rather arcane command, which sets the options for a communication 
method (device) directly from REXX. However, since the options strings for the device 
are not standardized, in order to find a specific parameter string, 
you will need to set the options manually in the session profile dialog and then 
query the current connection type's parameter string by pressing Shift+Ctrl+F10 in 
ZOC's main window. <br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
Let us assume you want to start a modem session on COM3 with 
57600 bps, RTS/CTS and Valid-CD active and a break time of 350ms. 
<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
<b>1.</b> Go to Options&rarr;Session Profile&rarr;Connection Type, select Serial/Modem and 
the set these options.<br> 
<b>2.</b> Close the session profile window using 'Save'<br> 
<b>3.</b> Press Shift+Ctrl+F10 <br> 
<b>4.</b> The status output from that connection type will show the current device-parameter 
<font color="5080A0"><i>[1]COM3:57600-8N1|9|350</i></font> which you can use as a parameter to 
the ZocSetDeviceOpts command. <br> 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
/* Set serial options to:<br/> 
&nbsp;&nbsp;&nbsp;COM3, 57600-8N1, RTS/CTS, Valid-CD, 350ms */<br/> 
CALL ZocSetDeviceOpts "[1]COM3:57600-8N1|9|350"<br/> 
</div></span></font> 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
/* Select telnet and set options for<br/> 
&nbsp;&nbsp;&nbsp;"Start session with local echo" */<br/> 
CALL ZocSetDevice "TELNET"<br/> 
CALL ZocSetDeviceOpts "[3]12"<br/> 
</div></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocSetEmulation'></a><b>ZocSetEmulation &lt;emulationname&gt;</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
The ZocSetEmulation command allows a script to activate a different terminal emulation. 
The parameter can be one of the names shown in the 
Emulation section of the session profile dialog, e.g. <font class="example" color="207030" face="Courier New"><span class="example">VT220</span></font>, <font class="example" color="207030" face="Courier New"><span class="example">TN3270</span></font>, etc. 
&nbsp;<br/>&nbsp;<br/><b><font color="404060">Example</font>: </b><br/><img src="dummy.gif" alt="nil" width="100" height="6" /><br/><font class="example" color="207030" face="Courier New"><span class="example">CALL ZocSetEmulation "Xterm"</span></font><br/> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocSetHostEntry'></a><b>ZocSetHostEntry "name", "&lt;key&gt;=&lt;value&gt;"</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Sets a value for a host directory entry from a key-value pair. To find actual names 
for these key-value pairs, please check the file <font color="5080A0"><i>HostDirectory.zocini</i></font> (stored 
in the ZOC data folder) using an editor. The file contains all the key-value pairs that 
make up your host directory.<br> 
See the <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSetSessionOption>ZocSetSessionOption</a></span></font> command for more background about key-value pair 
handling in general. 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
CALL ZocSetHostEntry "MyBBS", "emulation=1"<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
pair= ZocGetHostEntry("ZOC Support BBS", "calls")<br/> 
PARSE VALUE pair WITH key"="value<br/> 
value= value+1<br/> 
CALL ZocSetHostEntry "ZOC Support BBS", "calls="||value<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
/* mind the mixture of quotes in the commands below */<br/> 
value= "555-1234"<br/> 
CALL ZocSetHostEntry "ZOC Support BBS", 'connectto="555-1234"'<br/> 
CALL ZocSetHostEntry "ZOC Support BBS", 'connectto="'||value||'"'<br/> 
</div></span></font> 
<br/>&nbsp;<br/>
<b>See also: </b> <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSetSessionOption>ZocSetSessionOption</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocGetHostEntry>ZocGetHostEntry</a></span></font> 
<br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocSetLogfileName'></a><b>ZocSetLogfileName &lt;filename&gt;</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Set new name for logging. 
&nbsp;<br/>&nbsp;<br/><b><font color="404060">Example</font>: </b><br/><img src="dummy.gif" alt="nil" width="100" height="6" /><br/><font class="example" color="207030" face="Courier New"><span class="example">CALL ZocSetLogfileName "Today.LOG"</span></font><br/> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocSetLogging'></a><b>ZocSetLogging 0|1 [,1]</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Suspend/resume logging. If a second parameter with value <font class="example" color="207030" face="Courier New"><span class="example">1</span></font> is given, 
ZocSetLogging will suppress the notification window. 
&nbsp;<br/>&nbsp;<br/><b><font color="404060">Example</font>: </b><br/><img src="dummy.gif" alt="nil" width="100" height="6" /><br/><font class="example" color="207030" face="Courier New"><span class="example">CALL ZocSetLogging 1</span></font><br/> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocSetMode'></a><b>ZocSetMode &lt;key&gt;, &lt;value&gt;</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
This commands allows you to set operation modes for some of the script 
commands. The following modes are supported: 
<table><tr><td><img src='dummy.gif' border='0' width='40' height='12' /></td><td></td></tr> 
<tr><td class="pthead2" colspan=2><b><font color="#505060">SAY</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
A value of <font class="syntax" color="4060A0" face="Courier New"><span class="syntax">RAW</span></font> sets the SAY command to <i><font face="Times New Roman">not</font></i> convert 
<a class="link" href=topic-HLP_APXCODES.html>control codes</a> like <font class="example" color="207030" face="Courier New"><span class="example">^M</span></font> into their respective character values. 
A value of <font class="syntax" color="4060A0" face="Courier New"><span class="syntax">COOKED</span></font> switches back to standard behavior. 
&nbsp;<br/>&nbsp;<br/><b><font color="404060">Example</font>: </b><br/><img src="dummy.gif" alt="nil" width="100" height="6" /><br/><font class="example" color="207030" face="Courier New"><span class="example">CALL ZocSetMode "SAY", "RAW"</span></font><br/> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">RESPOND</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
A value of <font class="syntax" color="4060A0" face="Courier New"><span class="syntax">RAW</span></font> sets the respond command to <i><font face="Times New Roman">not</font></i> 
convert control codes like <font class="example" color="207030" face="Courier New"><span class="example">^M</span></font> into their respective 
values for both sides of the command. 
&nbsp;<br/>&nbsp;<br/><b><font color="404060">Example</font>: </b><br/><img src="dummy.gif" alt="nil" width="100" height="6" /><br/><font class="example" color="207030" face="Courier New"><span class="example">CALL ZocSetMode "RESPOND", "RAW"</span></font><br/> 
</table><img src='dummy.gif' border='0' width='40' height='12' /><br/> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocSetProgramOption'></a><b>ZocSetProgramOption "&lt;key&gt;=&lt;value&gt;"</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
This command modifies a ZOC option from the <a class="link" href=topic-HLP_OPTIONS3.html>Options&rarr;Program Settings</a> dialog. 
(similarly <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSetSessionOption>ZocSetSessionOption</a></span></font> modifies the <a class="link" href=topic-HLP_OPTIONS1.html>Options&rarr;Session Profile</a>). 
The function basically 
works the same as <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSetSessionOption>ZocSetSessionOption</a></span></font> but the underlying file which contains 
the key-value pairs is <font color="5080A0"><i>Standard.zfg</i></font> You can load the file into an editor and you will 
see that the key names are mostly self explanatory. However, if you have problems finding 
or using a specific key or value, please contact our support. 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
CALL ZocSetProgramOption "SafAskClrCapt=yes"<br/> 
CALL ZocSetProgramOption 'ScriptPath="ZocREXX"' /* mind the quotes */<br/> 
CALL ZocSetProgramOption 'ScriptPath="'||pathvar||'"' /* mind the quotes */<br/> 
</div></span></font> 
<br/>&nbsp;<br/>
<b>See also: </b> ZocCommand("SAVEPROGRAMSETTINGS"), <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocGetSessionOption>ZocGetSessionOption</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSetSessionOption>ZocSetSessionOption</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocGetProgramOption>ZocGetProgramOption</a></span></font> 
<br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocSetSessionOption'></a><b>ZocSetSessionOption "&lt;key&gt;=&lt;value&gt;"</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Sets a ZOC option from the <a class="link" href=topic-HLP_OPTIONS1.html>Options&rarr;Session Profiles</a> window, based on 
a key-value pair. To find out more about the key-value pairs, please have a look at the contents 
of the <font color="5080A0"><i>Standard.zoc</i></font> file (or any other *.zoc session profile). The file contains all 
the key-value pairs, which make up a session profile.<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
If you are not sure what the value of a certain key means, just set the option you want to change 
in the options window, then click Save and check the options file for the new key-value pair. 
You can also contact our customer support if you have specific questions about a key or value. 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
CALL ZocSetSessionOption "JumpScroll=3"<br/> 
CALL ZocSetSessionOption "ShowChat=no"<br/> 
CALL ZocSetSessionOption 'MdmIni="ATZ^M"' /* mind the quotes */<br/> 
CALL ZocSetSessionOption 'TransAutoRemove="'||valvar||'"' /* mind the quotes */<br/> 
</div></span></font> 
<br/>&nbsp;<br/>
<b>Note: </b>ZocSetSessionOption/ZocGetSessionOption will only work for options from the 
<a class="link" href=topic-HLP_OPTIONS1.html>Options&rarr;Session Profile</a> dialog. To change 
<a class="link" href=topic-HLP_OPTIONS3.html>Options&rarr;Program Settings</a>, use <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSetProgramOption>ZocSetProgramOption</a></span></font> 
<br/>&nbsp;<br/>
<b>See also: </b> <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocGetSessionOption>ZocGetSessionOption</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocGetProgramOption>ZocGetProgramOption</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSetProgramOption>ZocSetProgramOption</a></span></font> 
<br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocSetTimer'></a><b>ZocSetTimer &lt;hh:mm:ss&gt;</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Set connection timer to given time. If called with an empty parameter, the function will 
return the current duration of the session timer in seconds. Calling the function with 
a parameter string <font class="example" color="207030" face="Courier New"><span class="example">"STOP"</span></font> will hold the timer and <font class="example" color="207030" face="Courier New"><span class="example">"RESUME"</span></font> will continue with 
a held timer. 
&nbsp;<br/>&nbsp;<br/><b><font color="404060">Example</font>: </b><br/><img src="dummy.gif" alt="nil" width="100" height="6" /><br/><font class="example" color="207030" face="Courier New"><span class="example">CALL ZocSetTimer "00:00:20"</span></font><br/> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocSetUnattended'></a><b>ZocSetUnattended 0|1</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Enable or disable ZOC's unattended mode (same as <a class="link" href=topic-HLP_START_PARM.html>command line parameter /U</a>). 
&nbsp;<br/>&nbsp;<br/><b><font color="404060">Example</font>: </b><br/><img src="dummy.gif" alt="nil" width="100" height="6" /><br/><font class="example" color="207030" face="Courier New"><span class="example">CALL ZocSetUnattended 1</span></font><br/> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocShell'></a><b>ZocShell &lt;command&gt;, [&lt;viewmode&gt;]</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Execute a command or program in a shell window via 
<font color="5080A0"><i>cmd.exe /c &lt;command&gt;</i></font> (Windows) or <font color="5080A0"><i>/bin/bash -c "&lt;command&gt;"</i></font> (Mac OS X). 
This is similar to using to REXX's native <font class="example" color="207030" face="Courier New"><span class="example">ADDRESS CMD "&lt;command&gt;"</span></font> and essentially 
allows the execution of anything that you can execute in the shell/terminal window of the 
operating system. 
<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
Windows only: The optional viewmode parameter controls how the black shell window is 
shown:<br> 0= normal, 1= hidden, 2= minimized, 3= maximized.<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
In many cases ZocShell is identical to using the native REXX shell interface 
via <font class="example" color="207030" face="Courier New"><span class="example">ADDRESS CMD "&lt;command&gt;"</span></font> 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
CALL ZocShell "DEL FILE.TMP"<br/> 
CALL ZocShell "touch /tmp/file.lck", 1<br/> 
</div></span></font> 
<br/>&nbsp;<br/>
<b>See also: </b> <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocShellExec>ZocShellExec</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocShellOpen>ZocShellOpen</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocFileDelete>ZocFileDelete</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocFileRename>ZocFileRename</a></span></font> 
<br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocShellExec'></a><b>ZocShellExec &lt;command&gt;[, &lt;viewmode&gt;]</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Execute a program directly (i.e. without passing it through the shell's 
command interpreter, thus avoiding the overhead of running the shell). 
Under Windows this only works for .com and .exe files (i.e. it will not work 
for .CMD scripts and internal shell commands like DEL, REN etc.).<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
The optional viewmode parameter controls how the application window is 
shown:<br>0= normal, 1= hidden, 2= minimized, 3= maximized.<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
ZocShellExec also returns the exit code of the application to the 
REXX script. 
&nbsp;<br/>&nbsp;<br/><b><font color="404060">Example</font>: </b><br/><img src="dummy.gif" alt="nil" width="100" height="6" /><br/><font class="example" color="207030" face="Courier New"><span class="example">CALL ZocShellExec 'notepad.exe "somefile.txt"'</span></font><br/> 
<br/>&nbsp;<br/>
<b>See also: </b> <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocShell>ZocShell</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocShellOpen>ZocShellOpen</a></span></font> 
<br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocShellOpen'></a><b>ZocShellOpen &lt;filename&gt;</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
This function is somewhat equivalent of a double click on a file, because it passes 
a filename to the operating system with a request to open it. The operating system 
will then start the program which is associated with the type of that file (e.g. a 
PDF viewer for PDF files or Notepad for TXT files).<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
Alternately, an URL can be passed as a parameter instead of a filename. 
&nbsp;<br/>&nbsp;<br/><b><font color="404060">Example</font>: </b><br/><img src="dummy.gif" alt="nil" width="100" height="6" /><br/><font class="example" color="207030" face="Courier New"><span class="example">CALL ZocShellOpen 'C:\DOWNLOADS\Report.pdf'</span></font><br/> 
&nbsp;<br/>&nbsp;<br/><b><font color="404060">Example</font>: </b><br/><img src="dummy.gif" alt="nil" width="100" height="6" /><br/><font class="example" color="207030" face="Courier New"><span class="example">CALL ZocShellOpen 'http://www.emtec.com/'</span></font><br/> 
<br/>&nbsp;<br/>
<b>See also: </b> <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocShell>ZocShell</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocShellExec>ZocShellExec</a></span></font> 
<br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocString'></a><b>ZocString(&lt;subcommand&gt;, &lt;inputstring&gt;, &lt;p1&gt; [, &lt;p2&gt;])</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
This is a function to manipulate a string and return a modified copy. The subcommand 
and the parameters &lt;p1&gt; and &lt;p2&gt; control the modification. 
<table><tr><td><img src='dummy.gif' border='0' width='40' height='12' /></td><td></td></tr> 
<tr><td class="pthead2" colspan=2><b><font color="#505060">LINE</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Return the &lt;p1&gt;th element of &lt;inputstring&gt; which is delimited by a line feed (hex 0A) 
and stripped of leading or trailing carriage return characters (hex 0D) (simply speaking, this 
refers to the &lt;p1&gt;th line). This is useful to parse multiline results from a 
<font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocReceiveBuf>ZocReceiveBuf</a></span></font> call, e.g. <font class="example" color="207030" face="Courier New"><span class="example">name= ZocString("LINE", data, 4)</span></font> 
will return the 4th line from the data variable. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">LINECOUNT</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Returns the number of elements in &lt;inputstring&gt; which are accessible as LINE. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">PART</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Return the &lt;p1&gt;th part of &lt;inputstring&gt; which is delimited by &lt;p2&gt;, 
e.g. <font class="example" color="207030" face="Courier New"><span class="example">name= ZocString("PART", "Anne|Charly|Joe", 2, "|")</span></font> 
will return "Charly". 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">PARTCOUNT</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Return the number of &lt;p1&gt;-delimited parts in &lt;inputstring&gt;, 
e.g. <font class="example" color="207030" face="Courier New"><span class="example">count= ZocString("PARTCOUNT", "Anne|Charly|Joe", "|")</span></font> will return 3. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">REPLACE</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Return a copy of &lt;inputstring&gt; where all occurrences of &lt;p1&gt; are replaced by &lt;p2&gt;, 
e.g. <font class="example" color="207030" face="Courier New"><span class="example">betterstr= ZocString("REPLACE", str, "HyperTerminal", "ZOC")</span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">REMOVE</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Return a copy of &lt;inputstring&gt; where all occurrences of &lt;p1&gt; are removed, 
e.g. <font class="example" color="207030" face="Courier New"><span class="example">betterstr= ZocString("REMOVE", str, "HyperTerminal")</span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">REMOVECHARS</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Return a copy of &lt;inputstring&gt; from which all characters of &lt;p1&gt; were removed, 
e.g. <font class="example" color="207030" face="Courier New"><span class="example">str= ZocString("REMOVECHARS", str, "0123456789"||X2C(09))</span></font> removes 
all digits and tab characters from STR. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">WORD</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Return the &lt;p1&gt;th element of &lt;inputstring&gt; which is delimited by a space, 
e.g. <font class="example" color="207030" face="Courier New"><span class="example">name= ZocString("WORD", "The quick brown fox", 3)</span></font> 
will return "brown". Same as REXX's native WORD() function. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">WORDCOUNT</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Return the number of elements of &lt;inputstring&gt; accessible as WORD. 
</table><img src='dummy.gif' border='0' width='40' height='12' /><br/> 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
CALL ZocReceiveBuf 1024<br/> 
CALL ZocSend "ps^M"<br/> 
CALL ZocWait "$"<br/> 
data= ZocReceiveBuf(0)<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
/* display result list line by<br/> 
&nbsp;&nbsp;&nbsp;line but ignoring the first*/<br/> 
howmany= ZocString("LINECOUNT", data)<br/> 
DO i=2 TO howmany<br/> 
&nbsp;SAY ZocString("LINE", data, i)<br/> 
END<br/> 
</div></span></font> 
<br/>&nbsp;<br/>
<b>See also: </b> <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocCtrlString>ZocCtrlString</a></span></font> 
<br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocSuppressOutput'></a><b>ZocSuppressOutput 0|1</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Enables or disables suppressing of screen output. This command allows 
you to send/receive characters without any screen activity. Logging 
to the capture buffer and to file is also suppressed. <br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
Output suppression is automatically reset to normal when the script 
ends or upon disconnecting from a host. <br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocSynctime'></a><b>ZocSynctime &lt;time&gt;</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
This command lets you define the sync-time period (the default time is 
250ms).<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
Background: Because REXX programs are running parallel to ZOC, the main window may 
receive and process more incoming data while REXX is performing its own work. 
This means that in some situations it is possible that text, which you expect to be 
received and which are going to wait for, has actually already scrolled by. &nbsp;</p><p> 
A typical example for this is a loop that attempts to 
process all incoming lines of text.<br> 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
DO FOREVER<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;timeout= ZocWaitLine()<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;IF timeout\=640 THEN DO<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;    data= ZocLastLine()<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;    /* process data in some way */<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;END<br/> 
END<br/> 
</div></span></font> 
<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
In this example ZOC could receive more text while the REXX program 
still processes the data from <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocLastLine>ZocLastLine</a></span></font> and before it is ready to 
loop and issue the next <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocWaitLine>ZocWaitLine</a></span></font><br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
To address this problem, ZOC's processing of incoming traffic is suspended 
for a short time period (the sync-time) whenever a Wait-command has been 
satisfied, thus giving the REXX program time to process the result and 
to get ready to wait for more data.<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
After a Wait-command (ZocWait, ZocWaitMux, etc.), ZOC will resume processing of 
incoming data either if the sync-time has elapsed or if the REXX program issues 
another Wait-command or if another command is processed, which needs to interact 
with the main window (ZocWrite, ZocSend, etc. but also SAY, TRACE, because those 
output to the main window). 
<br/>&nbsp;<br/>
<b>Important: </b> Instead of increasing the sync-time, in loops like the above, you 
should consider to merely collect and store the data for later processing (the 
<font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocWaitLine>ZocWaitLine</a></span></font> command has an example of how to do this properly). 
An even better alternative is the use <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocReceiveBuf>ZocReceiveBuf</a></span></font> to catch all 
the data in one packet.<br> 
<br/>&nbsp;<br/>
<b>See also: </b> <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocWait>ZocWait</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocWaitIdle>ZocWaitIdle</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocWaitLine>ZocWaitLine</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocWaitMux>ZocWaitMux</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocReceiveBuf>ZocReceiveBuf</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocLastLine>ZocLastLine</a></span></font> 
<br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocTerminate'></a><b>ZocTerminate [&lt;return-code&gt;]</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Causes ZOC to end the program and close after the REXX program has ended. Usually 
an <font class="example" color="207030" face="Courier New"><span class="example">EXIT</span></font> command will follow ZocTerminate.&nbsp;</p><p> 
If you supply the return-code parameter, the ZOC process will return this value 
to the operating system or to the calling program. 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
CALL ZocTerminate<br/> 
EXIT<br/> 
</div></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocTimeout'></a><b>ZocTimeout &lt;sec&gt;</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Set max. time to wait for a ZocWait/ZocWaitMux/ZocWaitLine/ZocEventSemaphore command. 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
/* Make subsequent ZocWait commands expire after 30 seconds */<br/> 
CALL ZocTimeout 30<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
/* Wait until the host sends 'ready' of until the timeout expires */<br/> 
timeouttimeout= ZocWait("ready")<br/> 
IF timeout=640 THEN SAY "ready-prompt not received within 30 seconds"<br/> 
</div></span></font> 
<br/>&nbsp;<br/>
<b>See also: </b> <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocWait>ZocWait</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocWaitIdle>ZocWaitIdle</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocWaitLine>ZocWaitLine</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocWaitMux>ZocWaitMux</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocEventSemaphore>ZocEventSemaphore</a><dummy></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSyncTime>ZocSyncTime</a></span></font> 
<br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocUpload'></a><b>ZocUpload &lt;protocol&gt;[:&lt;options&gt;], &lt;filename&gt;</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Start to upload the file designated by &lt;filename&gt; using the given file 
transfer protocol. <br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
If the filename contains no path, it is taken from the standard upload 
directory, otherwise, if the path is relative, it is accessed based on 
ZOC's working directory.<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
For file transfer protocols which support multiple files (Ymodem, Zmodem), 
the file parameter may contain wildcards. Multiple filenames may be provided 
as one string in which the file names are separated by vertical bars 
<font class="example" color="207030" face="Courier New"><span class="example">*.pdf|somefile.txt</span></font> 
<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
The protocol name is <font class="example" color="207030" face="Courier New"><span class="example">BINARY</span></font>, <font class="example" color="207030" face="Courier New"><span class="example">ASCII</span></font> or the name of a file 
transfer protocol from the <a class="link" href=topic-DLG_WIN_OPTS_TRANSFER.html>Options&rarr;Session Profile&rarr;File Transfer</a> 
dialog, e.g. <font class="example" color="207030" face="Courier New"><span class="example">Zmodem</span></font> or <font class="example" color="207030" face="Courier New"><span class="example">Kermit</span></font>.<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
Depending on the success of the transfer, ZocUpload returns <font class="example" color="207030" face="Courier New"><span class="example">##OK##</span></font> or <font class="example" color="207030" face="Courier New"><span class="example">##ERROR##</span></font>. <br> 
&nbsp;<br/>&nbsp;<br/><b><font color="404060">Example</font>: </b><br/><img src="dummy.gif" alt="nil" width="100" height="6" /><br/><font class="example" color="207030" face="Courier New"><span class="example">CALL ZocUpload "ZMODEM", "REPQWK\ZOCBBS.REP"</span></font><br/> 
uploads C:\COMM\ZOC\REPQWK\ZOCBBS.REP via Zmodem protocol. 
&nbsp;<br/>&nbsp;<br/><b><font color="404060">Example</font>: </b><br/><img src="dummy.gif" alt="nil" width="100" height="6" /><br/><font class="example" color="207030" face="Courier New"><span class="example">success= ZocUpload("XMODEM", "ZOC.ZIP")</span></font><br/> 
uploads ZOC.ZIP (from the upload dir) via Xmodem protocol and obtains a 
success indicator (<font class="example" color="207030" face="Courier New"><span class="example">##OK##</span></font> or <font class="example" color="207030" face="Courier New"><span class="example">##ERROR##</span></font>). 
&nbsp;<br/>&nbsp;<br/><b><font color="404060">Example</font>: </b><br/><img src="dummy.gif" alt="nil" width="100" height="6" /><br/><font class="example" color="207030" face="Courier New"><span class="example">CALL ZocUpload "BINARY", "CNC-CONTROL.DAT"</span></font><br/> 
sends the contents of the file directly without any translation or protocol. 
&nbsp;<br/>&nbsp;<br/><b><font color="404060">Example</font>: </b><br/><img src="dummy.gif" alt="nil" width="100" height="6" /><br/><font class="example" color="207030" face="Courier New"><span class="example">CALL ZocUpload "ASCII", "commands.txt"</span></font><br/> 
uploads commands.txt using the text sending options which are currently 
configured in the session profile. 
&nbsp;<br/>&nbsp;<br/><b><font color="404060">Example</font>: </b><br/><img src="dummy.gif" alt="nil" width="100" height="6" /><br/><font class="example" color="207030" face="Courier New"><span class="example">CALL ZocUpload "ASCII:0+10", "\FAR\AWAY\LIST.TXT"</span></font><br/> 
uploads LIST.TXT via ascii transfer without CR/LF translation and a character 
delay of 10ms. 
&nbsp;<br/>&nbsp;<br/><b><font color="404060">Example</font>: </b><br/><img src="dummy.gif" alt="nil" width="100" height="6" /><br/><font class="example" color="207030" face="Courier New"><span class="example">CALL ZocUpload "ASCII:1+3", "HERE\SOME.DATA"</span></font><br/> 
uploads the file SOME.DATA via ascii transfer with CR/LF translation and a 
character delay of 3ms. 
<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
<br> 
<b>Transfer Options</b><br> 
The optional options are set by using a string that configures that 
protocol. Valid strings can be obtained, if you set your protocol options 
in ZOC's <a class="link" href=topic-DLG_WIN_OPTS_TRANSFER.html>Options&rarr;Session Profile&rarr;File Transfer</a> 
dialog, press Save and then edit the <font class="example" color="207030" face="Courier New"><span class="example">Options\Standard.zoc</span></font> 
file on your hard disk. The <font color="5080A0"><i>[OPTS_TRANSFER]</i></font> 
section will contain an <font class="example" color="207030" face="Courier New"><span class="example">ActiveTransfer=n</span></font> entry (e.g. n=2 for Zmodem) and 
a list of entries named <font class="example" color="207030" face="Courier New"><span class="example">TransferOpts#nn</span></font> each of which corresponds to one 
file transfer protocol (<font class="example" color="207030" face="Courier New"><span class="example">TransferOpts#02</span></font> being the Zmodem settings).<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
Example: If you want to make a transfer via Xmodem via CRC and 1KB 
blocks, you select Xmodem and define these options in ZOC's 
<a class="link" href=topic-DLG_WIN_OPTS_TRANSFER.html>Options&rarr;Session Profile&rarr;Transfer</a> dialog. 
Then, look at the <font class="example" color="207030" face="Courier New"><span class="example">Options\Standard.zoc</span></font> file using an editor and you 
will find the following lines: 
<br/><font class="example" color="207030" face="Courier New"><span class="example">&nbsp;<div class="lines"> 
ActiveTransfer=0<br/> 
TransferOpts#00="[0]kc"<br/> 
</div></span></font> 
Hence, to make a REXX upload using the Xmodem protocol configured for 
CRC and 1KB blocks, use the command 
<font class="example" color="207030" face="Courier New"><span class="example">CALL ZocUpload "XMODEM:[0]kc", "datafile.zip"</span></font> 
(please note that the options are case sensitive). 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocWait'></a><b>ZocWait(&lt;text&gt;)</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Waits until the given text is received. If ZocWait times out (see <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocTimeout>ZocTimeout</a></span></font>), 
it returns a value of 640. 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
CALL ZocTimeout 20<br/> 
timeout= ZocWait("Password")<br/> 
IF timeout=640 THEN SAY "Password prompt not received within 20 seconds"<br/> 
ELSE CALL ZocSend "alohomora^m"<br/> 
</div></span></font> 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
CALL ZocTimeout 10<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
timeout= ZocWait("enter command&gt;")<br/> 
IF timeout=640 THEN SIGNAL the_end<br/> 
CALL ZocSend "ENABLE FIREWALL^M"<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
timeout= ZocWait("enter command&gt;")<br/> 
IF timeout=640 THEN SIGNAL the_end<br/> 
CALL ZocSend "ENABLE IPFILTER^M"<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
timeout= ZocWait("enter command&gt;")<br/> 
IF timeout=640 THEN SIGNAL the_end<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
SAY "Firewall and Ip-Filter activated!"<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
the_end:<br/> 
Call ZocDisconnct<br/> 
</div></span></font> 
<br/>&nbsp;<br/>
<b>Note: </b>ZOC automatically filters ANSI/VTxxx/etc. control sequences from the 
data stream to avoid interference with the ZocWait command (see <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocWaitForSeq>ZocWaitForSeq</a></span></font>). 
<br/>&nbsp;<br/>
<b>Note: </b>If you are using ZocWait from a DDE controller, the command must be 
sent as via request rather than via execute 
<br/>&nbsp;<br/>
<b>Note: </b>With the TN3270 and TN5250 emulations, the command can only be 
used to wait for <font class="example" color="207030" face="Courier New"><span class="example">"^Z"</span></font>, which is used as a marker that indicates 
that the emulation is ready to accept input again. 
<br> 
<br/>&nbsp;<br/>
<b>See also: </b> <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocWaitIdle>ZocWaitIdle</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocWaitLine>ZocWaitLine</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocWaitMux>ZocWaitMux</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocTimeout>ZocTimeout</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocReceiveBuf>ZocReceiveBuf</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocLastLine>ZocLastLine</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSyncTime>ZocSyncTime</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocWaitForSeq>ZocWaitForSeq</a></span></font> 
<br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocWaitForSeq'></a><b>ZocWaitForSeq 1|0</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Normally Wait-commands ignore emulation control sequences in the data stream. 
If you need to wait for an emulation control, you can use this command to enable 
their visibility to the Wait commands. <br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
This command also turns on/off filtering of emulation controls for <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocReceiveBuf>ZocReceiveBuf</a></span></font> 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
esc= ZocCtrlString("^[")<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
/* wait for VT220 color reset */<br/> 
CALL ZocWaitForSeq 1<br/> 
Call ZocWait esc||"[0m"<br/> 
</div></span></font> 
<br/>&nbsp;<br/>
<b>See also: </b> <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocWait>ZocWait</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocWaiMux>ZocWaiMux</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocReceiveBuf>ZocReceiveBuf</a></span></font> 
<br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocWaitIdle'></a><b>ZocWaitIdle(&lt;time&gt;)</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Wait until there was no data received from the remote host for the given 
amount of time (in seconds). <br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
If the host keeps sending data, the command will 
time out after the time set by <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocTimeout>ZocTimeout</a></span></font> (a value of 640 will be returned 
to indicate the timeout). 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
CALL ZocTimeout 60<br/> 
timeout= ZocWaitIdle(2.5)<br/> 
IF timeout=640 THEN SAY "Host kept sending a steady stream of data for 60 seconds"<br/> 
ELSE SAY "OK, finally the host did stop the chatter (2.5 seconds of silence detected)"<br/> 
</div></span></font> 
<br/>&nbsp;<br/>
<b>See also: </b> <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocWait>ZocWait</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocWaitLine>ZocWaitLine</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocWaitMux>ZocWaitMux</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocTimeout>ZocTimeout</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSyncTime>ZocSyncTime</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocReceiveBuf>ZocReceiveBuf</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocLastLine>ZocLastLine</a></span></font> 
<br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocWaitLine'></a><b>ZocWaitLine()</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Wait for the next non empty line of text from the remote host (if you want to wait 
for the next line, no matter if empty or not, use EXMLPL(ZocWait "^M")).<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
The received text will then be available using the <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocLastLine>ZocLastLine</a></span></font> function 
or it can be accessed with some extra coding via <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocReceiveBuf>ZocReceiveBuf</a></span></font><br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
If ZocWaitLine times out, it returns a value of 640. 
<br/>&nbsp;<br/>
<b>Note: </b>Since REXX is running in its own thread, it is possible that 
ZocWaitLine will miss lines if new text is received by ZOC while the the REXX program 
is still processing the previously received data. Thus, especially when using 
ZocWaitLine in a loop, you should just just collect the data until it is complete and 
then process it in a 2nd pass (see the sample below and the description of the 
<font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSyncTime>ZocSyncTime</a></span></font> command). 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
rc= ZocWaitLine()<br/> 
IF rc\=640 THEN DO<br/> 
&nbsp;reply= ZocLastLine()<br/> 
&nbsp;IF reply=="CONNECT" THEN ...<br/> 
</div></span></font> 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
/* issue a command that outputs a bunch of lines of data */<br/> 
CALL ZocSend 'dig emtec.com && echo "&lt;&lt;END&gt;&gt;"^M'<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
/* first collect all the data and store it in an array */<br/> 
n= 0<br/> 
DO FOREVER<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;timeout= ZocWaitLine()<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;/* exit loop if no more data */<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;IF timeout=640 THEN LEAVE<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;line= ZocLastLine()<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;/* exit loop on a line meeting some condition */<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;IF line=="&lt;&lt;END&gt;&gt;" THEN LEAVE<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;/* store line in array */<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;n= n+1<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;data.n= line<br/> 
&nbsp;data.0= n<br/> 
END<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
/* when done, process each line of collected data in a 2nd pass */<br/> 
DO i= 1 TO data.0<br/> 
&nbsp;line= data.i<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
&nbsp;/* line can now leisurly be processed<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;without fear of missing data */<br/> 
END<br/> 
</div></span></font> 
<br/>&nbsp;<br/>
<b>See also: </b> <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocWait>ZocWait</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocWaitIdle>ZocWaitIdle</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocWaitMux>ZocWaitMux</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocTimeout>ZocTimeout</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSyncTime>ZocSyncTime</a></span></font> 
<br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocWaitMux'></a><b>ZocWaitMux(&lt;text0&gt; [, &lt;text1&gt; ...])</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Wait for one of multiple texts in the input data stream. The command will return 
if one of the given texts is found in the incoming data stream or after the default 
timeout has expired. The return code provides information about which text was 
found (0, 1, 2 ...) or if the command timed out (return code 640). 
<br/>&nbsp;<br/>
<b>Note: </b>The sum of the lengths of all texts must not exceed 4096 characters. 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
CALL ZoctTimeout 45<br/> 
ret= ZocWaitMux("You have mail", "Main Menu")<br/> 
SELECT<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;WHEN ret=0 THEN CALL handle_maildownload<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;WHEN ret=1 THEN LEAVE<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;WHEN ret=640 THEN SIGNAL handle_error<br/> 
END<br/> 
</div></span></font> 
<br/>&nbsp;<br/>
<b>See also: </b> <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocWait>ZocWait</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocWaitIdle>ZocWaitIdle</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocWaitLine>ZocWaitLine</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocTimeout>ZocTimeout</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSyncTime>ZocSyncTime</a></span>{{/font> 
<br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocWindowState'></a><b>ZocWindowState(MINIMIZE|MAXIMIZE|RESTORE|ACTIVATE|MOVE:x,y|QUERY)</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Set the State of ZOC's main window to the state given or moves the window 
to the given pixel coordinate (e.g. <font class="example" color="207030" face="Courier New"><span class="example">MOVE:20,100</span></font>). <br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
In used in function call syntax, the command will return new state of the window.<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
A parameter string of <font color="5080A0"><i>QUERY</i></font> will just return the current 
window state as <font color="5080A0"><i>MINIMIZED</i></font>, <font color="5080A0"><i>MAXIMIZED</i></font> or <font color="5080A0"><i>RESTORED</i></font> 
(please note the extra letter D at the end of those words). 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
now= ZocWindowState("QUERY")<br/> 
IF now\="MINIMIZED" THEN DO<br/> 
&nbsp;CALL ZocWindowState "MINIMIZE"<br/> 
END<br/> 
</div></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocWrite'></a><b>ZocWrite &lt;text&gt;</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Write text to screen. This command is similar to REXX's native SAY command, 
but it does not place the cursor in the next line after printing the text and 
it understands <a class="link" href=topic-HLP_APXCODES.html>control codes</a> like <font class="example" color="207030" face="Courier New"><span class="example">^M</span></font> (Enter) or <font class="example" color="207030" face="Courier New"><span class="example">^[</span></font> (ESC). 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
/* use a VT220 escape sequence to highlight a word */<br/> 
CALL ZocWrite "Hello ^[[1m World^[[0m"<br/> 
</div></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocWriteln'></a><b>ZocWriteln &lt;text&gt;</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Write text to screen and skip to the next line. This command is similar to the 
REXX SAY command, but it resolves <a class="link" href=topic-HLP_APXCODES.html>control codes</a> 
(e.g. <font class="example" color="207030" face="Courier New"><span class="example">^[</span></font> for ESC). 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
CALL ZocWriteln "Hello ^M^J World"<br/> 
SAY "Hello"||X2C(0D)||X2C(0A)||"World"<br/> 
</div></span></font> 
</table>&nbsp;<br/> 
&nbsp;</p><p>&nbsp;&nbsp;</p><p> 
&nbsp;</p><p> 
&nbsp;<br/><table class="hlbox" width="99%" cellpadding="0" cellspacing="0"><tr class="hlbox"><td class="hlbox"><b>Obsolete Functions</b></td></tr></table><img src="dummy.gif" alt="nil" width="200" height="12" /><br/> 
<table><tr><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td>&nbsp;</td></tr> 
<tr><td class="pthead1" colspan=2><a name='ZocAutoConnect'></a><b>ZocAutoConnect</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Renamed to <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocConnectHostdirEntry>ZocConnectHostdirEntry</a></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocAskP'></a><b>ZocAskP</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Renamed to <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocAskPassword>ZocAskPassword</a></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocBaud'></a><b>ZocBaud</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Replaced by <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSetDeviceParm>ZocSetDeviceParm</a></span></font>, e.g <font class="example" color="207030" face="Courier New"><span class="example">CALL ZocSetDeviceParm "[1]38400-8N1"</span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocCaptClr'></a><b>ZocCaptClr</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Replaced by <font class="example" color="207030" face="Courier New"><span class="example">ZocCommand("CLEARSCROLLBACK")</span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocCarrier'></a><b>ZocCarrier()</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Replaced by <font class="example" color="207030" face="Courier New"><span class="example">ZocGetInfo("ONLINE")</span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocCls'></a><b>ZocCls)</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Renamed to <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocClearScreen>ZocClearScreen</a></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocCursor'></a><b>ZocCursor</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Replaced by <font class="example" color="207030" face="Courier New"><span class="example">ZocGetInfo("CURSOR-X")</span></font> and <font class="example" color="207030" face="Courier New"><span class="example">ZocGetInfo("CURSOR-Y")</span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocDial'></a><b>ZocDial()</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Renamed to <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocConnect>ZocConnect</a></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocEndZoc'></a><b>ZocEndZoc()</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Replaced by <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocTerminate>ZocTerminate</a></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocExec'></a><b>ZocExec</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Renamed to <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocShellExec>ZocShellExec</a></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocGetFilename'></a><b>ZocGetFilename(s)</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Renamed to <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocAskFilename>ZocAskFilename</a></span></font>, <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocAskFilesnames>ZocAskFilesnames</a></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocGetFolderName'></a><b>ZocGetFolderName</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Renamed to <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocAskFolderName>ZocAskFolderName</a></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocGetLine'></a><b>ZocGetLine</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Renamed to <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocWaitLine>ZocWaitLine</a></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocGetPhonebk'></a><b>ZocGetPhonebk</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Renamed to <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocGetHostEntry>ZocGetHostEntry</a></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocGetOption'></a><b>ZocGetOption</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Renamed to <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocGetSessionOption>ZocGetSessionOption</a></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocLockKeyboard'></a><b>ZocLockKeyboard</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Replaced by <font class="example" color="207030" face="Courier New"><span class="example">ZocKeyboard("LOCK")</span></font> and <font class="example" color="207030" face="Courier New"><span class="example">ZocKeyboard("UNLOCK")</span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocLoadOpts'></a><b>ZocLoadOpts</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Renamed to <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocLoadSessionProfile>ZocLoadSessionProfile</a></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocLoadKeyfile'></a><b>ZocLoadKeyfile</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Renamed to <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocLoadKeyboardProfile>ZocLoadKeyboardProfile</a></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocLogging'></a><b>ZocLogging</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Renamed to <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSetLogging>ZocSetLogging</a></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocLogname'></a><b>ZocLogname</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Renamed to <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSetLogfileName>ZocSetLogfileName</a></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocRestimer'></a><b>ZocRestimer</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Replaced by <font class="example" color="207030" face="Courier New"><span class="example">ZocSetTimer("00:00:00")</span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocSaveOpts'></a><b>ZocSaveOpts</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Renamed to <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSaveSessionProfile>ZocSaveSessionProfile</a></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocScreen'></a><b>ZocScreen</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Renamed to <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocGetScreen>ZocGetScreen</a></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocSendBreak'></a><b>ZocSendBreak</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Replaced by <font class="example" color="207030" face="Courier New"><span class="example">ZocCommand("SENDBREAK")</span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocSendKey'></a><b>ZocSendKey &lt;number&gt;</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Please use <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocGetSessionOption>ZocGetSessionOption</a></span></font> and <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSend>ZocSend</a></span></font> instead. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocSetDevParm'></a><b>ZocSetDevParm</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Renamed to <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSetDeviceOpts>ZocSetDeviceOpts</a></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocSetDlPath'></a><b>ZocSetDlPath</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Please use <font class="example" color="207030" face="Courier New"><span class="example">CALL ZocSetProgramOption "DownloadPath=&lt;path&gt;"</span></font> instead. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocSetPhonebk'></a><b>ZocSetPhonebk</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Renamed to <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSetHostEntry>ZocSetHostEntry</a></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocSetEmu'></a><b>ZocSetEmu</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Please use <font class="example" color="207030" face="Courier New"><span class="example">CALL ZocSetSessionOption "ActiveEmulation=&lt;emu-id&gt;"</span></font> or ZocSetEmulation. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocSetHost'></a><b>ZocSetHost 0|1</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Please use <font class="example" color="207030" face="Courier New"><span class="example">CALL ZocSetSessionOption "Host=yes|no"</span></font> instead. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><a name='ZocSetOption'></a><b>ZocSetOption</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Renamed to <font class="example" color="207030" face="Courier New"><span class="example"><a class="link" href=topic-HLP_APXRXCMDS.html#ZocSetSessionOption>ZocSetSessionOption</a></span></font> 
</table>&nbsp;<br/> 
&nbsp;</p>
<p>&nbsp;</p>
</BODY>
</HTML>
