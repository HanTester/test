<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<META HTTP-EQUIV="Content-Style-Type" content="text/css">
<LINK REL="stylesheet" type="text/css" href="helpfile.css">
<TITLE>REXX Language Elements</TITLE>

</HEAD>

<BODY STYLE="FONT-FAMILY: Lucida Grande, Arial, Sans Serif; FONT-SIZE: 10pt;" BGCOLOR="#FFFFFF" TEXT="#000000">

<A NAME="HLP_REXXREF"></A>


<!-- \page -->
<!-- {\footnote HLP_REXXREF} -->
<!-- {\footnote REXX Language Elements} -->

<h2>REXX Language Elements</h2><p>

&nbsp;<br/><table class="hlbox" width="99%" cellpadding="0" cellspacing="0"><tr class="hlbox"><td class="hlbox"><b>Overview</b></td></tr></table> 
This topic offers an overview of the most commonly used parts of the 
native REXX language (a more basic introduction to ZOC programming can 
be found in <a class="link" href=topic-HLP_REXX.html>REXX Programming</a>). &nbsp;</p><p> 
The REXX language in combination with ZOC basically consists of three parts: <br> 
1. Basic REXX instructions (<font class="example" color="207030" face="Courier New"><span class="example">CALL</span></font>, <font class="example" color="207030" face="Courier New"><span class="example">IF</span></font>, <font class="example" color="207030" face="Courier New"><span class="example">END</span></font>, etc.)<br> 
2. REXX built in functions. (<font class="example" color="207030" face="Courier New"><span class="example">TIME()</span></font>, <font class="example" color="207030" face="Courier New"><span class="example">SUBSTR()</span></font>, <font class="example" color="207030" face="Courier New"><span class="example">STRIP()</span></font>, etc.)<br> 
3. ZOC Extensions (<font class="example" color="207030" face="Courier New"><span class="example">ZocSend</span></font>, <font class="example" color="207030" face="Courier New"><span class="example">ZocDownload</span></font>, <font class="example" color="207030" face="Courier New"><span class="example">ZocWait</span></font>, etc.)&nbsp;</p><p> 
This topic covers the essential parts of points 1. and 2.. &nbsp;</p><p> 
ZOC specific extension (3.) are listed in <a class="link" href=topic-HLP_APXRXCMDS.html>ZOC-REXX Commands/Functions</a>. 
&nbsp;</p><p>&nbsp;&nbsp;</p><p> 
If you look at the <font color="5080A0"><i>My Documents&rarr;ZOC Files&rarr;REXX</i></font> folder on your 
computer, you will find a link to <a class="ilink" href="http://www.emtec.com/downloads/zoc/rexx/docs/ZocRexxReference.pdf" target="_blank">ZOC REXX Reference (PDF)</a>, 
document, which will cover all three points above in great depth. A link to other 
<a class="ilink" href="http://www.emtec.com/zoc/documents.html#rexxfiles" target="_blank">REXX resources</a> 
can also be found there. 
&nbsp;</p><p> 
Last but not least, there is a ZIP archive with Zoc scripting samples 
(<a class="ilink" href="http://www.emtec.com/downloads/zoc/rexx/ZocScriptingSamples.zip" target="_blank">ZocScriptingSamples.zip</a>) 
in the folder mentioned above. Most of the topics which are presented here, 
are also demonstrated in the those samples.<br> 
&nbsp;</p><p>&nbsp;&nbsp;</p><p> 
&nbsp;<br/><table class="hlbox" width="99%" cellpadding="0" cellspacing="0"><tr class="hlbox"><td class="hlbox"><b>Essential REXX Language Elements</b></td></tr></table> 
<table><tr><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td>&nbsp;</td></tr> 
<tr><td class="pthead1" colspan=2><b>Command Placement</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
In REXX comments can span multiple lines when they are placed between 
<font class="syntax" color="4060A0" face="Courier New"><span class="syntax">/*</span></font> and <font class="syntax" color="4060A0" face="Courier New"><span class="syntax">*/</span></font>. 
REXX also knows single line comments, which start with a <font class="syntax" color="4060A0" face="Courier New"><span class="syntax">--</span></font> sequence 
and which automatically end when the line ends.<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
More than one command can be placed in one line by separating them 
by semicolons. <br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
A command can be continued in the next line by placing an 
<i><font face="Times New Roman">extra</font></i> comma at the end of the line. 
<br/><font class="example" color="207030" face="Courier New"><span class="example">&nbsp;<div class="lines"> 
/* REXX<br/> 
&nbsp;&nbsp;&nbsp;Placement Sample */<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
SAY "Hello "; SAY "World"<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
CALL zoc "REQUEST", "What do you think?", ,<br/> 
&nbsp;&nbsp;&nbsp;&nbsp; "Do not know", "Do not care"<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
answer= ZOCRESULT()<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
-- now we're done<br/> 
EXIT<br/> 
</div></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><b>Numbers and Arithmetics</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Numbers can be used for calculation, counting etc. REXX uses 
numbers and the arithmetic in a pretty straightforward way: 
<br/><font class="example" color="207030" face="Courier New"><span class="example">&nbsp;<div class="lines"> 
/* REXX */<br/> 
SAY 4*5+3*5 /* Output: 35 */<br/> 
SAY 10/3 /* Output: 3.333333 */<br/> 
SAY 10%3 /* Output: 3 (integral division) */<br/> 
SAY 10//3 /* Output: 1 (division remainder) */<br/> 
N= 4<br/> 
SAY N /* Output: 4 */<br/> 
N= N+1<br/> 
SAY N*3 /* Output: 15 */<br/> 
</div></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><b>Strings</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
REXX programs often process text in one way or another. While REXX 
inherently knows no types (values are treated as numbers or strings 
depending on the context), it is generally better to put all 
text strings in single or double quotes: 
<br/><font class="example" color="207030" face="Courier New"><span class="example">&nbsp;<div class="lines"> 
/* REXX */<br/> 
SAY "Hello World!"<br/> 
SAY "Joe's Bar"<br/> 
SAY 'He suggested: "Use ZOC!"'<br/> 
SAY 'She replied: "That''s my program!"'<br/> 
</div></span></font> 
&nbsp;</p><p> 
You can assign strings to variables. Strings in quotes and string variables can simply 
be concatenated by writing them after oneanother, although sometimes the string concatenation 
operator <font class="example" color="207030" face="Courier New"><span class="example">||</span></font> can be used for clarity or to to resolve ambiguities.: 
<br/><font class="example" color="207030" face="Courier New"><span class="example">&nbsp;<div class="lines"> 
/* REXX */<br/> 
w= "World"<br/> 
ex= "!"<br/> 
w2= w||ex /* the || operator is actually required here: w||ex vs. wex */<br/> 
hwe= "Hello "w2<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
-- say five times "Hello World!"<br/> 
SAY hwe<br/> 
SAY "Hello" w2<br/> 
SAY "Hello "w2<br/> 
SAY "Hello "||w2<br/> 
SAY "Hello "||w||ex<br/> 
</div></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><b>Tracing</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
To find errors in your REXX program (or to watch the program execution) 
you can insert a <font class="example" color="207030" face="Courier New"><span class="example">TRACE A</span></font> command into your REXX program (usually 
after the initial comment). With that, the REXX interpreter will display 
each instruction in the program as it executes it. <br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
<font class="example" color="207030" face="Courier New"><span class="example">TRACE I</span></font> will show very detailed tracing and <font class="example" color="207030" face="Courier New"><span class="example">TRACE O</span></font> 
turns tracing off.<br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><b>Conditionals</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
To express conditions in REXX programs, the following conditional operators 
are used:&nbsp;</p><p> 
<table class="outertable" cellspacing="0" cellpadding="8"><tr><td><table class="table" cellspacing="0" cellpadding="4"> 
<tr class="table"> 
<td class="tablehdr"><b>Operator</b> 
</td><td class="tablehdr"><b>Function</b> 
</td><td class="tablehdr"><b>Example</b> 
</td></tr><tr class="table"> 
<td class="table">= 
</td><td class="table">equal (numbers) 
</td><td class="table"><font class="example" color="207030" face="Courier New"><span class="example">IF ret=640 THEN ...</span></font> 
</td></tr><tr class="table"> 
<td class="table">== 
</td><td class="table">exactly equal (strings) 
</td><td class="table"><font class="example" color="207030" face="Courier New"><span class="example">IF input=="ZOC" THEN ...</span></font> 
</td></tr><tr class="table"> 
<td class="table">&lt;&gt; 
</td><td class="table">not equal 
</td><td class="table"><font class="example" color="207030" face="Courier New"><span class="example">IF rc&lt;&gt;640 THEN ...</span></font> 
</td></tr><tr class="table"> 
<td class="table">\= 
</td><td class="table">not equal (same as &lt;&gt;) 
</td><td class="table"><font class="example" color="207030" face="Courier New"><span class="example">IF rc\=640 THEN ...</span></font> 
</td></tr><tr class="table"> 
<td class="table">&lt; 
</td><td class="table">less 
</td><td class="table"><font class="example" color="207030" face="Courier New"><span class="example">IF val&lt;10 THEN ...</span></font> 
</td></tr><tr class="table"> 
<td class="table">&gt; 
</td><td class="table">greater 
</td><td class="table"><font class="example" color="207030" face="Courier New"><span class="example">IF val&gt;50 THEN ...</span></font> 
</td></tr><tr class="table"> 
<td class="table">&lt;= 
</td><td class="table">less or equal 
</td><td class="table"><font class="example" color="207030" face="Courier New"><span class="example">IF val&lt;=100 THEN ...</span></font> 
</td></tr><tr class="table"> 
<td class="table">&gt;= 
</td><td class="table">greater or equal 
</td><td class="table"><font class="example" color="207030" face="Courier New"><span class="example">IF val&gt;=100 THEN ...</span></font> 
</td></tr><tr class="table"> 
<td class="table">& 
</td><td class="table">AND 
</td><td class="table"><font class="example" color="207030" face="Courier New"><span class="example">IF (i&gt;=0) & (i&lt;10) THEN ...</span></font> 
</td></tr><tr class="table"> 
<td class="table">| 
</td><td class="table">OR 
</td><td class="table"><font class="example" color="207030" face="Courier New"><span class="example">IF (k=0) | (k=1) THEN ...</span></font> 
</td></tr><tr class="table"> 
<td class="table">\ 
</td><td class="table">NOT 
</td><td class="table"><font class="example" color="207030" face="Courier New"><span class="example">IF \(k=0) THEN ...</span></font> 
</table></td></tr></table> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><b>Decisions</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Decisions are made using the 
<font class="syntax" color="4060A0" face="Courier New"><span class="syntax">IF &lt;condition&gt; THEN DO &lt;commands&gt; END ELSE DO &lt;commands&gt; END</span></font> 
sequence (see above for conditionals).<br> 
A typical program part using an <font class="syntax" color="4060A0" face="Courier New"><span class="syntax">IF</span></font> command looks like 
this: 
<br/><font class="example" color="207030" face="Courier New"><span class="example">&nbsp;<div class="lines"> 
/* REXX */<br/> 
IF rc=0 | rc=1 THEN DO /* rc 0 oder rc 1 */<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;SAY "ok"<br/> 
END<br/> 
ELSE DO<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;SAY "failed"<br/> 
END<br/> 
</div></span></font> 
<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
The ELSE-part can be omitted if it is not needed. The keywords 
<font class="syntax" color="4060A0" face="Courier New"><span class="syntax">DO</span></font> and <font class="syntax" color="4060A0" face="Courier New"><span class="syntax">END</span></font> can be omitted if only one command is to be 
executed conditionally.: 
<br/><font class="example" color="207030" face="Courier New"><span class="example">&nbsp;<div class="lines"> 
/* REXX */<br/> 
IF rc=0 | rc=1 THEN SAY "ok"<br/> 
ELSE SAY "failed"<br/> 
</div></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><b>Loops</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Loops are expressed in the following form:<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
<font class="syntax" color="4060A0" face="Courier New"><span class="syntax">DO &lt;count&gt; &lt;commands&gt; END</span></font><br> 
<font class="syntax" color="4060A0" face="Courier New"><span class="syntax">DO WHILE &lt;condition&gt; &lt;commands&gt; END</span></font><br> 
<font class="syntax" color="4060A0" face="Courier New"><span class="syntax">DO UNTIL &lt;condition&gt; &lt;commands&gt; END</span></font><br> 
<font class="syntax" color="4060A0" face="Courier New"><span class="syntax">DO &lt;variable&gt;=&lt;start&gt; TO &lt;end&gt; &lt;commands&gt; END</span></font><br> 
<br> 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
/* REXX */<br/> 
DO 5<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;SAY "Hello"<br/> 
END<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
N= 100<br/> 
DO WHILE n&gt;0<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;SAY n<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;n= n-1<br/> 
END<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
DO i=1 TO 10<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;SAY i<br/> 
END<br/> 
</div></span></font> 
<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
Loops can be aborted from within using the <font class="example" color="207030" face="Courier New"><span class="example">LEAVE</span></font> command. The <font class="example" color="207030" face="Courier New"><span class="example">ITERATE</span></font> 
command will skip the rest of the loop body for the current iteration and will continue 
with the next loop iteration. 
<br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><b>Jumps and Procedures (Subroutines)</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Jump targets (labels) and subroutines are marked with a name and a colon. 
To jump to a label, use the <font class="example" color="207030" face="Courier New"><span class="example">SIGNAL</span></font> command.<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
The <font class="example" color="207030" face="Courier New"><span class="example">CALL</span></font> command is used to call a subroutine (which will return to the 
place it was called from via <font class="example" color="207030" face="Courier New"><span class="example">RETURN</span></font>).<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
The following example demonstrates a jump and a call to a subroutine 
with argument passing: 
<br/><font class="example" color="207030" face="Courier New"><span class="example">&nbsp;<div class="lines"> 
/* REXX */<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
PULL n<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
IF n=0 THEN SIGNAL get_out<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
teny= 10/n<br/> 
SAY "10/"n "is" teny<br/> 
CALL square n<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
get_out:<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
EXIT<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
square:<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;value= ARG(1)<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;sqr= value*value<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;SAY "Square of "||value||" is "||sqr<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
</div></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><b>Function Calls</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Functions are marked and called like procedures. The difference is that 
the can return a value to the calling command: 
<br/><font class="example" color="207030" face="Courier New"><span class="example">&nbsp;<div class="lines"> 
/* REXX */<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
SAY "Enter base"<br/> 
PULL b<br/> 
SAY "Enter power"<br/> 
PULL p<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
result= power(b,p)<br/> 
SAY "The " p "th power of " b " is " result<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
EXIT<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
power:<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;base= ARG(1)<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;pow= ARG(2)<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;res= 1<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;DO I=1 TO pow<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;    res= res*base<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;END<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;RETURN res<br/> 
</div></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><b>External Calls</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
It is also possible to call an external script file as a subroutine and pick 
up a possible result. 
To do this, the name of the external script files needs to be placed in quotes. 
The called script then needs to be placed either in the ZOC program folder, 
in the ZOC Files folder, in the ZOC script files folder or in a folder which is 
listed in the PATH or REGINA_MACROS variable in the system environment 
(e.g. C:\WINDOWS).<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
Alternately you can specify a full folder and file name for the file. Parameters 
are passed as usual (separated by commas).<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
If you have a scriptname or path in a REXX variable the regular call Syntax will 
not work though, but you can build a string which contains the complete command 
and pass it through the INTERPRET command (see the sample below). 
<br/><font class="example" color="207030" face="Courier New"><span class="example">&nbsp;<div class="lines"> 
/* REXX:test.zrx */<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
/* call external script in one of the ZOC folders */<br/> 
CALL "sub.zrx" "Hello", "World"<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
/* call external script in an external folder */<br/> 
CALL "C:\rexxlib\sub.zrx" "Hello", "World"<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
/* call external script as function */<br/> 
x= "sub.zrx"(12,2)<br/> 
SAY x<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
/* call external script via INTERPRET */<br/> 
scriptfile= "Z:\test\zzz.zrx"<br/> 
cmd= 'CALL "'||scriptfile||'"'<br/> 
INTERPRET cmd<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
/* call external script as function via INTERPRET */<br/> 
scriptfile= "sub.zrx"<br/> 
cmd= 'x= "'||scriptfile'"(12,2)'<br/> 
INTERPRET cmd<br/> 
SAY x<br/> 
</div></span></font> 
<br> 
The called script can pick up parameters through the built-in <font class="syntax" color="4060A0" face="Courier New"><span class="syntax">ARG(n)</span></font> function 
and return results via the <font class="syntax" color="4060A0" face="Courier New"><span class="syntax">RETURN</span></font> command: 
<br/><font class="example" color="207030" face="Courier New"><span class="example">&nbsp;<div class="lines"> 
/* REXX:sub.zrx */<br/> 
a= ARG(1)<br/> 
b= ARG(2)<br/> 
SAY a<br/> 
SAY b<br/> 
mult= a*b<br/> 
RETURN mult<br/> 
</div></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><b>The PARSE command</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
PARSE is a powerful REXX command which can be used to split formatted strings in 
parts and assign the parts to variables. The syntax is 
<font class="syntax" color="4060A0" face="Courier New"><span class="syntax">PARSE VALUE &lt;string&gt; WITH &lt;variable&gt;"&lt;delimiter&gt;"...</span></font><br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
For example, if you have a string coordinate in the form <font class="syntax" color="4060A0" face="Courier New"><span class="syntax">&lt;index&gt;: &lt;pos-x&gt;/&lt;pos-y&gt;</span></font> 
you can easily break it into parts via<br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
<font class="example" color="207030" face="Courier New"><span class="example">PARSE VALUE coord WITH index": "posx"/"posy</span></font> 
<br/>&nbsp;<br/><b><font color="404060">Example</font>:</b><font class="example" color="207030" face="Courier New"><span class="example"><div class="lines"> 
/* REXX SAMPLE TO GET VALUES FROM A COMMA SEPARATED LIST */<br/> 
x= "1, 2, 3, 4"<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
DO FOREVER<br/> 
&nbsp;IF x=="" THEN LEAVE<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;PARSE VALUE x WITH val", "rest<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
&nbsp;SAY val<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
&nbsp;x= rest<br/> 
END<br/> 
</div></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><b>Issuing ZOC Commands</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
ZOC commands are extensions to the REXX language which are implemented as procedures 
and functions (see <a class="link" href=topic-HLP_APXRXCMDS.html>ZOC-REXX Commands</a> for a list). <br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
ZOC commands that do not return a value (or if you are not interested in the 
return value) are called with the procedure call syntax: <br> 
<font class="syntax" color="4060A0" face="Courier New"><span class="syntax">CALL &lt;zoc-command&gt; &lt;argument(s)&gt;</span></font> <br><img src='dummy.gif' border='0' width='8' height='8' /><br> 
ZOC-commands that do return a value are called with the function call 
syntax: <br> 
<font class="syntax" color="4060A0" face="Courier New"><span class="syntax">&lt;result-var&gt;= &lt;zoc-command&gt;(&lt;argument(s)&gt;)</span></font> 
<br> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><b>Issuing Windows or OS X Shell Commands</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Commands which are intended to be executed by the operating system (like 
deleting or renaming files), must be addressed to the operating system 
directly. This can either be done through REXX's <font class="syntax" color="4060A0" face="Courier New"><span class="syntax">ADDRESS CMD</span></font> 
command or through ZOC's <font class="syntax" color="4060A0" face="Courier New"><span class="syntax">ZocShell</span></font> command. 
<br/><font class="example" color="207030" face="Courier New"><span class="example">&nbsp;<div class="lines"> 
/* REXX */<br/> 
ADDRESS CMD "cmd.exe /c DEL UPLOAD.TMP"<br/> 
ZocShell "DEL UPLOAD.TMP"<br/> 
</div></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><b>Built-In Functions</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
The functions below can be used in assignments or in other commands 
that expect values, e.g. <font class="example" color="207030" face="Courier New"><span class="example">b= ABS(a)</span></font> or 
<font class="example" color="207030" face="Courier New"><span class="example">IF ABS(n)&gt;10 THEN ...</span></font>.<br> 
<br/>&nbsp;<br/>
<b>Note: </b>Only the essential functions and arguments are listed here, 
for a complete description please see The 
<a class="ilink" href="http://www.emtec.com/downloads/zoc/rexx/docs/ZocRexxReference.pdf" target="_blank">ZOC REXX Reference (PDF)</a> 
in your <font color="5080A0"><i>My Documents&rarr;ZOC Files&rarr;REXX</i></font> folder. 
<br> 
<table><tr><td><img src='dummy.gif' border='0' width='40' height='12' /></td><td></td></tr> 
<tr><td class="pthead2" colspan=2><b><font color="#505060">ABS(&lt;value&gt;)</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Absolute value (remove sign), e.g. <font class="example" color="207030" face="Courier New"><span class="example">n=ABS(t)</span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">ARG(&lt;n&gt;)</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
The n-th argument of a procedure/function. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">COPIES(&lt;str&gt;,&lt;repeat&gt;)</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Return &lt;repeat&gt; copies of &lt;string&gt;, e.g. 
<font class="example" color="207030" face="Courier New"><span class="example">x=COPIES("-more- ", 10)</span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">C2D(&lt;char&gt;)</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Obtain the decimal ASCII value of a character 
(Char-TO-Decimal), e.g. <font class="example" color="207030" face="Courier New"><span class="example">n=C2D('A')</span></font> will set n to 65. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">C2X(&lt;char&gt;)</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Obtain the decimal ASCII value of one or more characters 
(Char-TO-heX), e.g. <font class="example" color="207030" face="Courier New"><span class="example">n=C2X('AB')</span></font> will set n to 4142. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">DATE("&lt;style&gt;")</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Return the current date in different styles (one of 
B, D, E, M, N, O, S, U, W), e.g. <font class="example" color="207030" face="Courier New"><span class="example">today=DATE("S")</span></font> will return 
<font class="example" color="207030" face="Courier New"><span class="example">"20080201"</span></font> on February 1st, 2008). 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">D2C(&lt;ascii&gt;)</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Create the character from a given ASCII value 
(Decimal-To-Character), e.g. <font class="example" color="207030" face="Courier New"><span class="example">SAY D2C(65)</span></font> will print the letter A 
or <font class="example" color="207030" face="Courier New"><span class="example">cr= D2C(13)</span></font> will assign the carriage return character to the 
variable CR. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">FILESPEC(&lt;part&gt;, &lt;filename&gt;)</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Cut a given part (one of "Drive", 
"Path", "Name") from a filename, e.g. <font class="example" color="207030" face="Courier New"><span class="example">dir=FILESPEC("Path", ofile)</span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">LEFT(&lt;string&gt;, &lt;num&gt;)</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Return the first &lt;num&gt; characters from 
&lt;string&gt;, e.g. <font class="example" color="207030" face="Courier New"><span class="example">SAY LEFT("BEERBOTTLE", 4)</span></font> will print BEER. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">LENGTH(&lt;string&gt;)</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Return the number of characters in a string. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">LINEIN(&lt;filename&gt;)</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Read the next line of text from a file (see FILE I/O). 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">LINEOUT(&lt;filename&gt;, &lt;text&gt;)</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Write a next line of text to a file 
(see FILE I/O). 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">POS(&lt;needle&gt;, &lt;haystack&gt;)</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Find the first string in the second and 
return the position or 0 if not found. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">RIGHT(&lt;string&gt;, &lt;num&gt;)</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Return the last &lt;num&gt; characters from 
&lt;string&gt;, e.g. <font class="example" color="207030" face="Courier New"><span class="example">SAY RIGHT("BEERBOTTLE", 6)</span></font> will print BOTTLE. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">STREAM(&lt;filename&gt;, ...)</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Perform a file control operation 
(see the FILE I/O section below). 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">SUBSTR(&lt;string&gt;, &lt;pos&gt;[, &lt;length&gt;])</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Return &lt;length&gt; characters 
from position &lt;pos&gt; in string. &lt;length&gt; can be omitted and will return 
the rest of the string. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">STRIP(&lt;string&gt;)</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Remove leading and trailing blanks from a string 
e.g. <font class="example" color="207030" face="Courier New"><span class="example">str= STRIP(str)</span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">TIME("&lt;style&gt;")</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Return the current time (style is one of C, H, L, M, N, 
S), e.g. SAY TIME("N") will show the time in HH:MM:SS format. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">TRANSLATE(&lt;string&gt;)</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Translate the characters in a string to upper case. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">TRUNC(&lt;n&gt;, &lt;m&gt;)</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Cut the value &lt;n&gt; so that it has &lt;m&gt; decimal places. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">X2C(&lt;ascii&gt;)</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
Create the character(s) from a given hex value 
(heX-To-Character), e.g. <font class="example" color="207030" face="Courier New"><span class="example">SAY X2C(41)</span></font> will print the letter A 
or <font class="example" color="207030" face="Courier New"><span class="example">crlf= X2C(0D0A)</span></font> will assign the carriage return and line feed 
characters to the variable CRLF. 
</table><img src='dummy.gif' border='0' width='40' height='12' /><br/> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><b>FILE I/O</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
<table><tr><td><img src='dummy.gif' border='0' width='40' height='12' /></td><td></td></tr> 
<tr><td class="pthead2" colspan=2><b><font color="#505060">Check if File Exists</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2"> 
<font class="syntax" color="4060A0" face="Courier New"><span class="syntax">IF STREAM(&lt;filename&gt;, "C", "QUERY EXISTS")\="" THEN ...</span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">Open for Writing</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2"> 
<font class="syntax" color="4060A0" face="Courier New"><span class="syntax">CALL STREAM &lt;filename&gt;, "C", "OPEN WRITE"</span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">Open for Reading</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2"> 
<font class="syntax" color="4060A0" face="Courier New"><span class="syntax">CALL STREAM &lt;filename&gt;, "C", "OPEN READ"</span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">Write to File</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2"> 
<font class="syntax" color="4060A0" face="Courier New"><span class="syntax">CALL LINEOUT &lt;filename&gt;, &lt;text&gt;</span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">Read from File</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2"> 
<font class="syntax" color="4060A0" face="Courier New"><span class="syntax">&lt;variable&gt;= LINEIN(&lt;filename&gt;)</span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">Check End of File</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2"> 
<font class="syntax" color="4060A0" face="Courier New"><span class="syntax">IF STREAM(&lt;filename&gt;, "S")\="READY" THEN ...</span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">Close File</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2"> 
<font class="syntax" color="4060A0" face="Courier New"><span class="syntax">CALL STREAM &lt;filename&gt;, "C", "CLOSE"</span></font> 
</table><img src='dummy.gif' border='0' width='40' height='12' /><br/> 
&nbsp;</p><p> 
<br/><font class="example" color="207030" face="Courier New"><span class="example">&nbsp;<div class="lines"> 
/* REXX FILE INPUT EXAMPLE */<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
file= "input.txt"<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
DO FOREVER<br/> 
&nbsp;ln= LINEIN(file)<br/> 
&nbsp;IF STREAM(file, "S")\="READY" THEN LEAVE<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
&nbsp;/* process line of file (ln) here */<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
END<br/> 
CALL STREAM file, "C", "CLOSE"<br/> 
</div></span></font> 
&nbsp;</p><p> 
Please also check the FILEIO sample in SCRIPT\RXSAMPLE\TUTORIAL directory. 
&nbsp;</p><p> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><b>Parameters to REXX Scripts</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
It is possible to pass a parameter to a REXX scripts from the ZOC command line 
(or ZOC user buttons), e.g. <font class="example" color="207030" face="Courier New"><span class="example">ZOC /RUN:script\test.zrx "/RUNARG:Hello, World"</span></font> &nbsp;</p><p> 
The parameter can be accessed 
via the ARG(1) function from within the REXX Script and if necessary be split 
using the <font class="example" color="207030" face="Courier New"><span class="example">PARSE</span></font> command (it is recommended to subsequently use the STRIP function 
to remove leading and trailing blanks from the parameters). 
<br/><font class="example" color="207030" face="Courier New"><span class="example">&nbsp;<div class="lines"> 
/* PARAMETERS TO REXX */<br/> 
p= ARG(1)<br/> 
PARSE VALUE p WITH p1","p2<br/> 
p1= STRIP(p1)<br/> 
p2= STRIP(p2)<br/> 
SAY "Parameters: ("||p||") ("||p1||") ("||p2||")"<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
</div></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><b>Equivalents to BASIC Commands</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
<table><tr><td><img src='dummy.gif' border='0' width='40' height='12' /></td><td></td></tr> 
<tr><td class="pthead2" colspan=2><b><font color="#505060">ASC</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
D2C() 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">CHR$</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
C2D(), X2C() 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">CLOSE</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
CALL STREAM(&lt;file&gt;, "C", "CLOSE") 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">EOF</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
STREAM(&lt;file&gt;, "S")\="READY" 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">FOR ... NEXT</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
DO n=&lt;first&gt; TO &lt;last&gt; ... END 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">INSTR$</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
POS() 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">MID$</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
SUBSTR() 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">LEN</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
LENGTH() 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">OPEN</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
STREAM(&lt;file&gt;, "C", "OPEN ...") 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">INPUT</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
PULL, ZocAsk() 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">INPUT#</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
LINEIN() 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">PRINT</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
SAY, ZocWrite, ZocWriteln 
<br/>&nbsp;</td></tr>
<tr><td class="pthead2" colspan=2><b><font color="#505060">PRINT#</font></b></td></tr>
<tr><td class="ptindent2">&nbsp;</td>	 <td class="ptbody2">
LINEOUT 
</table><img src='dummy.gif' border='0' width='40' height='12' /><br/> 
</table>&nbsp;<br/> 
&nbsp;</p>
<p>&nbsp;</p>
</BODY>
</HTML>
