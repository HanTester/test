<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<META HTTP-EQUIV="Content-Style-Type" content="text/css">
<LINK REL="stylesheet" type="text/css" href="helpfile.css">
<TITLE>Introduction to ZOC REXX</TITLE>

</HEAD>

<BODY STYLE="FONT-FAMILY: Lucida Grande, Arial, Sans Serif; FONT-SIZE: 10pt;" BGCOLOR="#FFFFFF" TEXT="#000000">

<A NAME="HLP_REXX"></A>


<!-- \page -->
<!-- {\footnote HLP_REXX} -->
<!-- {\footnote Introduction to ZOC REXX} -->

<h2>Introduction to ZOC REXX</h2><p>

&nbsp;<br/><table class="hlbox" width="99%" cellpadding="0" cellspacing="0"><tr class="hlbox"><td class="hlbox"><b>About REXX and ZOC</b></td></tr></table> 
The scripting language REXX has a long tradition as a scripting language, especially 
in the IBM world. It is a simple but powerful language which offers all language elements 
that are necessary for small and medium programming tasks (variables, decisions, loops, procedures, 
string manipulation, file I/O, etc.). There is even a REXX dialect (OOREXX) which offers object 
oriented language elements. 
&nbsp;</p><p> 
For scripting, ZOC uses this solid language as a foundation and extends it by adding 
specific functions for terminal emulation and communication. All these extensions have 
names starting with <font class="example" color="207030" face="Courier New"><span class="example">Zoc</span></font>, e.g. <font class="example" color="207030" face="Courier New"><span class="example">ZocConnect</span></font> or <font class="example" color="207030" face="Courier New"><span class="example">ZocSend</span></font>. 
&nbsp;</p><p> 
<br/>&nbsp;<br/>
<b>Note: </b> ZOC's implementation for the REXX interpreter for Windows and Mac OS X 
is Regina REXX (<a class="ilink" href="http://regina-rexx.sourceforge.net/" target="_blank">http://regina-rexx.sourceforge.net/</a>). If you prefer 
a different implementation (e.g. OOREXX), you can switch to that in 
<a class="link" href=topic-DLG_WIN_GLOB_SPECIALFILES.html>Options&rarr;Program Settings&rarr;Special Files&rarr;Alternate REXX-DLL</a>. 
&nbsp;</p><p>&nbsp;&nbsp;</p><p> 
&nbsp;<br/><table class="hlbox" width="99%" cellpadding="0" cellspacing="0"><tr class="hlbox"><td class="hlbox"><b>Learning ZOC REXX</b></td></tr></table> 
To get an impression of the language, you will find a quick tour through the very basics right below.&nbsp;</p><p> 
Once you completed this overview, continue with reading <a class="link" href=topic-HLP_REXXREF.html>REXX Language Elements</a> 
and <a class="link" href=topic-HLP_APXRXCMDS.html>ZOC-REXX Commands</a>. These two topics will cover all language elements 
which are necessary to perform the majority of your tasks..&nbsp;</p><p> 
Beyond that, you will find the 
<a class="ilink" href="http://www.emtec.com/downloads/zoc/rexx/ZocScriptingSamples.zip" target="_blank">ZocScriptingSamples.zip</a> 
archive in your <font color="5080A0"><i>My Documents&rarr;ZOC7 Files&rarr;REXX</i></font> folder helpful. It contains a series of 
step-by-step examples with increasing complexity. On our website we then offer even more 
<a class="ilink" href="http://www.emtec.com/zoc/documents.html#rexxfiles" target="_blank">links to tutorials and samples</a> 
&nbsp;</p><p> 
If you want to use REXX on a very sophisticated level, you can look into the full 
<a class="ilink" href="http://www.emtec.com/downloads/zoc/rexx/docs/ZocRexxReference.pdf" target="_blank">ZOC REXX Reference (PDF)</a>, 
which you will also find in your <font color="5080A0"><i>My Documents&rarr;ZOC7 Files&rarr;REXX</i></font> folder. 
&nbsp;</p><p>&nbsp;&nbsp;</p><p> 
&nbsp;<br/><table class="hlbox" width="99%" cellpadding="0" cellspacing="0"><tr class="hlbox"><td class="hlbox"><b>Hello World!</b></td></tr></table> 
ZOC REXX versions of the famous Hello World program looks like this: 
<br/><font class="example" color="207030" face="Courier New"><span class="example">&nbsp;<div class="lines"> 
/* REXX */<br/> 
-- Display "Hello World" on the local screen<br/> 
SAY "Hello World!"<br/> 
</div></span></font> 
<br/><font class="example" color="207030" face="Courier New"><span class="example">&nbsp;<div class="lines"> 
/* REXX */<br/> 
-- Send "Hello World" to the remote host<br/> 
CALL ZocSend "Hello World!"<br/> 
</div></span></font> 
<br/><font class="example" color="207030" face="Courier New"><span class="example">&nbsp;<div class="lines"> 
/* REXX */<br/> 
-- Make a remote Unix host say "Hello World"<br/> 
CALL ZocSend "echo 'Hello World!'^M"<br/> 
</div></span></font> 
&nbsp;</p><p>&nbsp;&nbsp;</p><p> 
&nbsp;<br/><table class="hlbox" width="99%" cellpadding="0" cellspacing="0"><tr class="hlbox"><td class="hlbox"><b>General Considerations</b></td></tr></table> 
Usually all REXX programs begin with a comment, which REXX defines 
as any text which is written between <font class="example" color="207030" face="Courier New"><span class="example">/*</span></font> and <font class="example" color="207030" face="Courier New"><span class="example">*/</span></font>. 
This means that the first line in all REXX programs looks like this: 
<font class="example" color="207030" face="Courier New"><span class="example">/*&nbsp;REXX&nbsp;*/</span></font>. In addition to that, REXX also knows 
a form of comment which runs to the end of line. These comments start 
with <font class="syntax" color="4060A0" face="Courier New"><span class="syntax">--</span></font> (see the above samples). 
&nbsp;</p><p> 
REXX knows native and non-native commands and functions. 
Examples for native commands are <font class="example" color="207030" face="Courier New"><span class="example">SAY</span></font>, <font class="example" color="207030" face="Courier New"><span class="example">IF</span></font>, <font class="example" color="207030" face="Courier New"><span class="example">DO</span></font>, <font class="example" color="207030" face="Courier New"><span class="example">END</span></font>. 
Some of the non-native (ZOC specific) commands are <font class="example" color="207030" face="Courier New"><span class="example">ZocSend</span></font>, 
<font class="example" color="207030" face="Courier New"><span class="example">ZocTimeout</span></font>, <font class="example" color="207030" face="Courier New"><span class="example">ZocDisconnect</span></font>. 
&nbsp;</p><p> 
For easier reference, native language elements will written in uppercase, e.g. 
<font class="example" color="207030" face="Courier New"><span class="example">CALL</span></font>, <font class="example" color="207030" face="Courier New"><span class="example">SELECT</span></font>, <font class="example" color="207030" face="Courier New"><span class="example">THEN</span></font>, <font class="example" color="207030" face="Courier New"><span class="example">SAY</span></font>. Zoc extension commands 
are written in <font color="5080A0"><i>CamelCase</i></font>, e.g. <font class="example" color="207030" face="Courier New"><span class="example">ZocConnect</span></font>, <font class="example" color="207030" face="Courier New"><span class="example">ZocSend</span></font>, etc. 
Finally names which are user defined (for example variables) are set in lowercase 
characters, <font class="example" color="207030" face="Courier New"><span class="example">result= 10*userinput</span></font>. 
&nbsp;</p><p>&nbsp;&nbsp;</p><p> 
&nbsp;<br/><table class="hlbox" width="99%" cellpadding="0" cellspacing="0"><tr class="hlbox"><td class="hlbox"><b>How to Use Different Types of Commands</b></td></tr></table> 
<table><tr><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td>&nbsp;</td></tr> 
<tr><td class="pthead1" colspan=2><b>Native Commands</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
You can use native commands by writing the command name and optional arguments. 
Their placement is governed by the REXX language syntax and they create the basic 
structure of the program (the all uppercase words below are all native REXX commands): 
<br/><font class="example" color="207030" face="Courier New"><span class="example">&nbsp;<div class="lines"> 
IF rc=640 THEN DO<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;SAY "Call Failed!"<br/> 
&nbsp;SIGNAL done<br/> 
END<br/> 
ELSE DO<br/> 
&nbsp;SAY "Success!"<br/> 
END<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
EXIT<br/> 
</div></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><b>ZOC-Commands</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
ZOC-commands are executed by means of REXX's subroutine or function call mechanism. 
Essentially they come in two flavors: 
&nbsp;</p><p> 
For commands which do not return a result (or if you do not care about the 
result), you use the <font class="example" color="207030" face="Courier New"><span class="example">CALL</span></font> command with the name of the ZOC-command and 
the required arguments separated by commas. &nbsp;</p><p> 
For commands which do return a value, 
you use an assignment and supply the argument list enclosed in brackets 
after the command name. 
<br/><font class="example" color="207030" face="Courier New"><span class="example">&nbsp;<div class="lines"> 
-- two commands without return values:<br/> 
CALL ZocBeep 2<br/> 
CALL ZocConnect "telnet.hogwarts.edu"<br/> 
CALL ZocDownload "ZMODEM", "SOMEFOLDER"<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
-- this is a command which returns a value:<br/> 
answer= ZocAsk("What is your name")<br/> 
</div></span></font> 
</table>&nbsp;<br/> 
&nbsp;</p><p>&nbsp;&nbsp;</p><p> 
&nbsp;<br/><table class="hlbox" width="99%" cellpadding="0" cellspacing="0"><tr class="hlbox"><td class="hlbox"><b>A Small Example</b></td></tr></table> 
Most of the time you will use REXX to log into a host and do things 
automatically.&nbsp;</p><p> 
While simple logins sequences can be stored directly in the host directory 
without scripting (see <a class="link" href=topic-DLG_WIN_PHONE_EDIT.html>Changing Host Directory Entries</a>), 
there is a limit to what these can do.&nbsp;</p><p> 
The example below shows a more complex case. It calls a SSH host and 
checks for email by issuing the <font color="5080A0"><i>mail</i></font> command on the host and 
looking at the result. 
<br/><font class="example" color="207030" face="Courier New"><span class="example">&nbsp;<div class="lines"> 
/*REXX*/<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
-- set variables for host login<br/> 
hostip= "users.hogwarts.edu"<br/> 
username= "harryp"<br/> 
password= "alohomora"<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
-- make an SSH connection to the host<br/> 
CALL ZocSetDevice "Secure Shell"<br/> 
CALL ZocConnect username":"password"@"hostip<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
-- if login works, we should see the "Last login"<br/> 
-- message within 10 seconds. (if ZocWait returns 640,<br/> 
-- it means it did not appear in time)<br/> 
CALL ZocTimeout 10<br/> 
x= ZocWait("Last login")<br/> 
IF x\=640 THEN DO<br/> 
&nbsp;-- we are in, so wait for a prompt<br/> 
&nbsp;CALL ZocWait "$"<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
&nbsp;-- send the mail command<br/> 
&nbsp;CALL ZocSend "mail^M"<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
&nbsp;-- skip the echo from our command<br/> 
&nbsp;CALL ZocWaitline<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
&nbsp;-- wait for one more line of output and grab it<br/> 
&nbsp;CALL ZocWaitline<br/> 
&nbsp;themail= ZocLastline()<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
&nbsp;-- logout and disconnect<br/> 
&nbsp;CALL ZocSend "exit^M"<br/> 
&nbsp;CALL ZocDelay 1<br/> 
&nbsp;CALL ZocDisconnect<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
&nbsp;/* if the reply from mail was different from "No mail for ..."<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;then display a message box to the user */<br/> 
&nbsp;IF LEFT(themail,7)\="No mail" THEN DO<br/> 
&nbsp;&nbsp;CALL ZocMsgBox themail<br/> 
&nbsp;END<br/> 
END<br/> 
</div></span></font> 
<br/>&nbsp;<br/>
<b>Note: </b> More samples can be found in the 
<a class="ilink" href="http://www.emtec.com/downloads/zoc/rexx/ZocScriptingSamples.zip" target="_blank">ZocScriptingSamples.zip</a> 
archive. 
&nbsp;</p><p>&nbsp;&nbsp;</p><p> 
&nbsp;<br/><table class="hlbox" width="99%" cellpadding="0" cellspacing="0"><tr class="hlbox"><td class="hlbox"><b>What now?</b></td></tr></table> 
Continue with the more detailed overview of <a class="link" href=topic-HLP_REXXREF.html>REXX Language Elements</a>. 
&nbsp;</p>
<p>&nbsp;</p>
</BODY>
</HTML>
