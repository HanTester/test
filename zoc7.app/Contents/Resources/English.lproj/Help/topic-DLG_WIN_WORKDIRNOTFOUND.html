<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<META HTTP-EQUIV="Content-Style-Type" content="text/css">
<LINK REL="stylesheet" type="text/css" href="helpfile.css">
<TITLE>Data Folder Selection (Workdir)</TITLE>

</HEAD>

<BODY STYLE="FONT-FAMILY: Lucida Grande, Arial, Sans Serif; FONT-SIZE: 10pt;" BGCOLOR="#FFFFFF" TEXT="#000000">

<A NAME="DLG_WIN_WORKDIRNOTFOUND"></A>


<!-- \page -->
<!-- {\footnote DLG_WIN_WORKDIRNOTFOUND} -->
<!-- {\footnote Data Folder Selection (Workdir)} -->

<h2>Data Folder Selection (Workdir)</h2><p>

ZOC stores its configuration files in a central folder, which is usually 
located in the User's "My Documents" folder.&nbsp;</p><p> 
If the data folder does not exist (because ZOC is started for the first time 
or because the folder was moved), the program will ask if a new folder 
should be created or where an existing folder is located. In case of 
new folder creation, ZOC will copy the files from the HIBLUR(newuserprofile_english) 
folder in the program directory to the user's new data folder.&nbsp;</p><p> 
The basis for this selection is the <font class="example" color="207030" face="Courier New"><span class="example">ConfigDataFolder</span></font> setting 
in the <font color="5080A0"><i>Admin.ini</i></font> file which is also located in the ZOC program 
directory. For single user installations, this setting will always 
point to the user folder (unless a working folder was specified on the 
command line via <font class="example" color="207030" face="Courier New"><span class="example">/WD</span></font> parameter.)&nbsp;</p><p> 
If the user changes the folder (e.g. by renaming it and then pointing 
ZOC to the new folder), the new selection will be written back to the 
<font color="5080A0"><i>Admin.ini</i></font> file. &nbsp;</p><p> 
For shared installations (installations, where the <font color="5080A0"><i>Admin.ini</i></font> file 
contains a setting of <font class="example" color="207030" face="Courier New"><span class="example">SharedInstall=yes</span></font>), the <font color="5080A0"><i>Admin.ini</i></font> will 
be used to specify the default location of the user data folder. 
However, if the user changes the location of his data folder, the new 
location will not be written to the <font color="5080A0"><i>Admin.ini</i></font> file (because 
that would affect other users). Instead, the user's choice will be 
stored in the user registry (Windows) or user preferences 
com.emtec.zoc7.plist (Mac OS X) 
under <font class="example" color="207030" face="Courier New"><span class="example">HKCU+Software+EmTec+UserConfigFolder</span></font>&nbsp;</p><p> 
The possibility of relocating the folder in a shared installation through 
a registry entry can be disabled in the <font color="5080A0"><i>Admin.ini</i></font> file by setting 
<font class="example" color="207030" face="Courier New"><span class="example">DisableRegistryConfigFolder=yes</span></font>. (The option to specify 
the working folder on the command line can also be disabled in the 
<font color="5080A0"><i>Admin.ini</i></font> file.)&nbsp;</p><p> 
This means that, unless the option is disabled, ZOC will first look 
for the <font class="example" color="207030" face="Courier New"><span class="example">/WD</span></font> parameter. If that is not present (or disabled), 
in a shared installation in which the registry config 
specification has not been disabled, ZOC will then check if a 
<font class="example" color="207030" face="Courier New"><span class="example">UserConfigFolder</span></font> entry is in the registry. If that entry 
is there it will use that value as the folder specification. If 
the installation is not shared or if the <font class="example" color="207030" face="Courier New"><span class="example">DisableRegistryConfigFolder</span></font> 
option is true, the location of the user data folder will always be 
taken from the <font color="5080A0"><i>Admin.ini</i></font> file.&nbsp;</p><p> 
In the next step, ZOC will load the program settings file, which 
by default is named <font class="example" color="207030" face="Courier New"><span class="example">Standard.zfg</span></font> and resides in the 
<font class="example" color="207030" face="Courier New"><span class="example">Options</span></font> subfolder of the user data folder, but which can 
be in an other location as per specification in the <font color="5080A0"><i>Admin.ini</i></font> file. 
This file will then point to the secondary data folder, 
where script files, logs, etc. are stored.&nbsp;</p><p> 
Although being a bit complex, this process allows maximum flexibility in defining 
the data structure and ranges from fully shared installations (where the user data folder 
points to a shared folder on the network), to mixed installations 
(where some folders are shared and other are per user) or fully 
individual data storage (user data folder in the user's "My Documents" 
folder, with a <font class="example" color="207030" face="Courier New"><span class="example">Standard.zfg</span></font> which has sub folder settings 
which are pointing also to locations in the user's realm. 
&nbsp;</p>
<p>&nbsp;</p>
</BODY>
</HTML>
