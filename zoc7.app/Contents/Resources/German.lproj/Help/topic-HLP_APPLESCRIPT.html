<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<META HTTP-EQUIV="Content-Style-Type" content="text/css">
<LINK REL="stylesheet" type="text/css" href="helpfile.css">
<TITLE>Einführung in ZOC-AppleScript Programmierung (Mac OS X)</TITLE>

</HEAD>

<BODY STYLE="FONT-FAMILY: Lucida Grande, Arial, Sans Serif; FONT-SIZE: 10pt;" BGCOLOR="#FFFFFF" TEXT="#000000">

<A NAME="HLP_APPLESCRIPT"></A>


<!-- \page -->
<!-- {\footnote HLP_APPLESCRIPT} -->
<!-- {\footnote Einführung in ZOC-AppleScript Programmierung (Mac OS X)} -->

<h2>Einführung in ZOC-AppleScript Programmierung (Mac OS X)</h2><p>

ZOC bietet ein simples Interface, um <a class="link" href=topic-HLP_APXRXCMDS.html>ZOC-Befehle</a> von 
AppleScript aus auszuführen. 
&nbsp;</p><p> 
Um ZOC auf die Befehls-Ausführung durch AppleScript vorzubereiten, 
müssen die auszuführenden Befehle zwischen <font class="example" color="207030" face="Courier New"><span class="example">start conversation</span></font> und 
<font class="example" color="207030" face="Courier New"><span class="example">end conversation</span></font> eingeschlossen werden. 
&nbsp;</p><p> 
&nbsp;<br/><table class="hlbox" width="99%" cellpadding="0" cellspacing="0"><tr class="hlbox"><td class="hlbox"><b>Aufruf von ZOC-Befehlen als Unterfunktion</b></td></tr></table><img src="dummy.gif" alt="nil" width="200" height="12" /><br/> 
ZOC-Befehle werden in AppleScript genau so verarbeitet, als wenn sie von 
innerhalb der ZOC-Skriptsprache (REXX) aus aufgerufen worden wären, und 
auch die Syntax ist ähnlich. Um einen Befehl auszuführen, muss dieser 
einfach mit Funktionsaufruf-Syntax angegeben werden (die gleiche Syntax, die 
auch für den Aufruf von Subroutinen innerhalb eines AppleScripts verwendet wird). 
&nbsp;</p><p> 
Ein einfaches AppleScript mit einem ZOC Funktionsaufruf sieht folglich 
so aus: 
<br/><font class="example" color="207030" face="Courier New"><span class="example">&nbsp;<div class="lines"> 
tell application "zoc7"<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;-- bereite die aktuelle Verbindung im ersten ZOC-Fenster auf die<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;-- Verarbeitung von ZOC-Befehlen vor<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;start conversation<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;-- sende 'ls -l&lt;enter&gt;' zur Gegenstelle<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;ZocSend("ls -l^M")<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;-- öffne in ZOC ein Abfragefenster und speichere die Auswahl<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;set reply to ZocRequest("Ihre Auswahl?", "Äpfel", "Orangen")<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;-- gebe die Befehls-Verarbeitung wieder frei<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;end conversation<br/> 
end tell<br/> 
</div></span></font> 
In der <a class="link" href=topic-HLP_APXRXCMDS.html>ZOC Funktionsliste</a> finden Sie eine 
Beschreibung sämtlicher Funktionen und Parameter (diese Liste kann 
auch direkt aus dem Hilfemenü von ZOC aufgerufen werden). Die Syntax 
der Befehle und die dort angegebenen Beispiele beziehen sich auf den 
in ZOC verwendeten internen REXX Skript-Interpreter, sollten aber 
zusammen mit dem obigen Beispiel selbsterklärend sein. 
&nbsp;</p><p> 
&nbsp;<br/><table class="hlbox" width="99%" cellpadding="0" cellspacing="0"><tr class="hlbox"><td class="hlbox"><b>Aufruf von ZOC-Befehlen mit 'perform'</b></td></tr></table><img src="dummy.gif" alt="nil" width="200" height="12" /><br/> 
Wenn Sie eine Syntax bevorzugen, die mehr an AppleScript angelehnt ist, 
können Sie ZOC-Befehle auch durch den <font class="example" color="207030" face="Courier New"><span class="example">perform</span></font> Befehl ausführen. 
Dieser Befehl erhält als direkten Parameter den Namen des ZOC-Befehls, 
sowie ein Array (in geschweiften Klammern), das alle Parameter für 
diesen Befehl enthält. 
&nbsp;</p><p> 
Diese Variante ist funktional identisch zum Aufruf als Unterfunktion. Es 
stellt lediglich eine Alternative dar: 
<br/><font class="example" color="207030" face="Courier New"><span class="example">&nbsp;<div class="lines"> 
tell application "zoc7"<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;-- bereite die aktuelle Verbindung im ersten ZOC-Fenster auf die<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;-- Verarbeitung von ZOC-Befehlen vor<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;start conversation<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;-- sende 'ls -l&lt;enter&gt;' zur Gegenstelle<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;perform "ZocSend" using { "ls -l^M" }<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;-- öffne in ZOC ein Abfragefenster und speichere die Auswahl<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;set reply to perform "ZocRequest" using<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;     { "Ihre Auswahl?", "Äpfel", "Orangen" }<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;-- gebe die Befehls-Verarbeitung wieder frei<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;end conversation<br/> 
end tell<br/> 
</div></span></font> 
&nbsp;</p>
<p>&nbsp;</p>
</BODY>
</HTML>
