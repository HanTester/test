<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<META HTTP-EQUIV="Content-Style-Type" content="text/css">
<LINK REL="stylesheet" type="text/css" href="helpfile.css">
<TITLE>Einführung in ZOC-DDE Programmierung (Windows)</TITLE>

</HEAD>

<BODY STYLE="FONT-FAMILY: Lucida Grande, Arial, Sans Serif; FONT-SIZE: 10pt;" BGCOLOR="#FFFFFF" TEXT="#000000">

<A NAME="HLP_DDE"></A>


<!-- \page -->
<!-- {\footnote HLP_DDE} -->
<!-- {\footnote Einführung in ZOC-DDE Programmierung (Windows)} -->

<h2>Einführung in ZOC-DDE Programmierung (Windows)</h2><p>

Dynamic Data Exchange (DDE) erlaubt anderen Windows-Programmen, ZOC-Befehle 
ferngesteuert auszuführen. Während <a class="link" href=topic-HLP_REXX.html>REXX-Programme</a> unter 
der Kontrolle von ZOC laufen müssen, ist es mit DDE möglich, dass völlig 
separate Anwendungen (z.B. in C++ geschrieben) Befehle an ZOC zur 
Ausführung schicken. 
&nbsp;</p><p>In dieser Einführung wird davon ausgegangen, dass Kenntnisse über 
das Grundkonzept von DDE vorhanden sind. Die unten aufgeführten Punkte 
beschreiben nur Details der Implementierung. 
&nbsp;</p><p>Eine detaillierte Beschreibung zusammen mit einem Beispielprogramm in C 
kann bei EmTec angefordert werden (<a class="ilink" href="ftp://ftp.emtec.com/zoc/" target="_blank">ftp://ftp.emtec.com/zoc/</a>). 
<table><tr><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td>&nbsp;</td></tr> 
<tr><td class="pthead1" colspan=2><b>Session/Topic</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
ZOC verarbeitet nur eine Session gleichzeitig. Der Application-Identifier 
ist <font class="example" color="207030" face="Courier New"><span class="example">ZOC</span></font>, und ZOC antwortet auf die Topics <font class="example" color="207030" face="Courier New"><span class="example">COMMUNICATION</span></font>, 
<font class="example" color="207030" face="Courier New"><span class="example">COMM</span></font> und <font class="example" color="207030" face="Courier New"><span class="example">COMM-DEBUG</span></font> (zweiterer zeigt zur Fehlersuche 
alle DDE-Events auf dem ZOC-Bildschirm an). ZOC antwortet nicht auf generelle 
DDE-Requests (also auf Requests ohne Application oder Topic). 
&nbsp;</p><p>Zusätzlich zum Namen <font class="example" color="207030" face="Courier New"><span class="example">ZOC</span></font> reagiert ZOC auch noch auf 
<font class="example" color="207030" face="Courier New"><span class="example">ZOCn</span></font>, wobei n eine Zahl ist, die sich aus der Anzahl der 
gleichzeitig gestarteten ZOC-Instanzen herleitet. Die erste heißt 
<font class="example" color="207030" face="Courier New"><span class="example">ZOC1</span></font>, die nächste <font class="example" color="207030" face="Courier New"><span class="example">ZOC2</span></font> usw. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><b>Das Senden von Befehlen</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Befehle können an ZOC entweder per DDE_EXECUTE (Datenfeld) oder DDE_REQUEST 
(Itemfeld) gesendet werden. DDE_EXECUTE antwortet mit einem DDE_ACK Paket. 
Der numerische Rückgabewert ist im Feld AppRc enthalten. DDE_REQUEST sendet 
immer ein DDE_DATA Paket (auch im Fehlerfall), welches das Ergebnis oder den 
Text <font class="example" color="207030" face="Courier New"><span class="example">##ERROR##</span></font> im Datenfeld enthält. Für das DDE_DATA Paket darf 
kein DDE_ACK zurückgeschickt werden. ZOC für Windows erwartet, dass der 
Speicherblock, der die Daten enthält, vom Empfänger freigegeben wird. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><b>Serialisierung</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Befehle müssen streng auf Basis von Command-Reply gesendet werden. ZOC 
verarbeitet keine geschachtelten Befehle (z.B. das Senden eines zweiten 
Befehls, während noch ein ZocWait abgearbeitet wird). 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><b>Befehlsformat</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
DDE_EXECUTE und DDE_REQUEST verwenden das gleiche Befehlsformat. (Beide 
Befehle unterscheiden sich dadurch, dass EXECUTE nicht verwendet werden 
kann, um Rückgabewerte von Funktionen zu liefern). Die Befehle müssen 
mit Null abgeschlossen werden (wie Zeichenketten in C). 
&nbsp;</p><p>ZOC kann keine Befehle verarbeiten, die in eckigen Klammern eingeschlossen 
sind (wie in der Microsoft DDE Spezifikation empfohlen). Außerdem kann nur 
ein Befehl pro Message verarbeitet werden. Unicode wird nicht unterstützt. 
&nbsp;</p><p>Ein Befehl kann entweder in der Form <font class="example" color="207030" face="Courier New"><span class="example">&lt;befehl&gt; &lt;argumente&gt;</span></font> oder 
in der Form <font class="example" color="207030" face="Courier New"><span class="example">&lt;befehl&gt;(&lt;argumente&gt;)</span></font> übergeben werden. Die Argumente 
können mit Leerzeichen oder Komma getrennt werden. Die empfohlene Form 
sind allerdings Klammern und Komma. Zeichenketten sollten in Anführungszeichen 
gesetzt werden, es ist aber auch erlaubt, sie wegzulassen, wenn die 
Zeichenkette keine Spezialzeichen enthält. 
&nbsp;</p><p>Anbei eine Liste gültiger Zeichenketten. Um zu älteren ZOC-Versionen 
kompatibel zu sein, ist es erlaubt, den Text 'Zoc' am Anfang jedes Befehls 
wegzulassen. 
<br/><font class="example" color="207030" face="Courier New"><span class="example">&nbsp;<div class="lines"> 
ZocBeep(2)<br/> 
ZocMsgBox("Hello World!", 2)<br/> 
ZocNotify('Datei "FOOBAR.DATA" nicht gefunden!')<br/> 
&nbsp;&nbsp;&nbsp;&nbsp;<br/> 
ZocRequest "Wie geht's?" "Gut" "Nicht schlecht"<br/> 
Notify Error<br/> 
Beep 2<br/> 
</div></span></font> 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><b>Liste der Befehle</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Per DDE kann der gleiche Befehls-/Funktionsumfang wie in REXX verwendet 
werden. Eine Auflistung aller Befehle ist unter 
<a class="link" href=topic-HLP_APXRXCMDS.html>ZOC-Befehle</a> im Anhang zu finden. 
<br/>&nbsp;</td></tr>
<tr><td class="pthead1" colspan=2><b>Beispiel</b></td></tr>
<tr><td class="ptindent1">&nbsp;</td>	 <td class="ptbody1"> 
Der folgende Ausschnitt ist ein kleines Microsoft Access Basic Programm, 
das eine DDE-Verbindung zu ZOC aufbaut, das Modem initialisiert, und 
auf "OK" wartet. 
<br/><font class="example" color="207030" face="Courier New"><span class="example">&nbsp;<div class="lines"> 
ZocDDE = DDEInitiate("ZOC", "Comm-Debug")<br/> 
DDEExecute ZocDDE, "ZocClearScreen"<br/> 
DDEExecute ZocDDE, "ZocTimeout(60)"<br/> 
DDEExecute ZocDDE, "ZocSend('ATZ^M')"<br/> 
rc = DDERequest(ZocDDE, "ZocWait('OK')")<br/> 
Debug.Print rc<br/> 
DDETerminate ZocDDE<br/> 
</div></span></font> 
</table>&nbsp;<br/> 
&nbsp;</p>
<p>&nbsp;</p>
</BODY>
</HTML>
